const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pose-C7hUOr9t-v7.js","assets/index-CdUgHszu-v7.js","assets/index-jqtUL3Ea-v7.css","assets/index-GNeIC8lQ-v7.js","assets/index-GAKaKZnS-v7.js"])))=>i.map(i=>d[i]);
import{r as n,h as Pt,f as $t,j as e,u as Ot,_ as lt}from"./index-CdUgHszu-v7.js";import{I as Ge}from"./CommonIcons-5q3SwwL--v7.js";import"./Share.es-CrG1KySg-v7.js";import"./Sun.es-DG79aZPN-v7.js";const Rt=[{id:"healing",label:"ì§€ì¹œ ë§ˆìŒì„ ë¹„ìš°ê³  ì‹¶ì–´ìš”",subtitle:"ì¹˜ìœ ì™€ ì´ì™„",description:"ë¹„ì›Œëƒ„ìœ¼ë¡œì¨ ë¹„ë¡œì†Œ í‰ì˜¨í•´ì§€ëŠ” ì‹œê°„ìž…ë‹ˆë‹¤.",emoji:"ðŸŒŠ",direction:"negative_to_zero"},{id:"growth",label:"ë°ì€ ì—ë„ˆì§€ë¥¼ ì±„ìš°ê³  ì‹¶ì–´ìš”",subtitle:"ì„±ìž¥ê³¼ ì—°ê²°",description:"ë‹¹ì‹ ì˜ ë‚´ë©´ì´ ê°€ì§„ ë³¸ì—°ì˜ ë¹›ì„ ê¹¨ìš°ëŠ” ì‹œê°„ìž…ë‹ˆë‹¤.",emoji:"âœ¨",direction:"zero_to_positive"}],Tt=[{id:"body_rest",category:"healing",label:"ì§€ì¹œ ëª¸ì— ê¹Šì€ íœ´ì‹ì„ ì„ ë¬¼í•˜ê³  ì‹¶ì–´ìš”",tag:"ì‹ ì²´",emoji:"ðŸ˜Œ",focus:"body",keywords:["ê·¼ìœ¡ ì´ì™„","ì•ˆì „ ì‹ í˜¸","ë°”ë””ìŠ¤ìº”"]},{id:"mind_calm",category:"healing",label:"í­í’ ê°™ì€ ìƒê°ë“¤ì„ ìž ìž¬ìš°ê³  ê³ ìš”í•´ì§€ê³  ì‹¶ì–´ìš”",tag:"ìƒê°",emoji:"ðŸƒ",focus:"mind",keywords:["ì¸ì§€ ê³¼ë¶€í•˜","ìƒê° ë¶„ë¦¬","í˜¸í¡ ì§‘ì¤‘"]},{id:"emotion_release",category:"healing",label:"ë‚´ ì•ˆì— ìŒ“ì¸ ê°ì •ì˜ ì°Œêº¼ê¸°ë¥¼ í˜ë ¤ë³´ë‚´ê³  ì‹¶ì–´ìš”",tag:"ê°ì •",emoji:"ðŸŒ§ï¸",focus:"emotion",keywords:["ê°ì • ë°°ì¶œ","ì •ì„œì  ê³µê°„ í™•ë³´"]},{id:"let_go",category:"healing",label:"í†µì œí•  ìˆ˜ ì—†ëŠ” ë¶ˆì•ˆì„ ê·¸ë§Œ ë‚´ë ¤ë†“ê³  ì‹¶ì–´ìš”",tag:"ë‚´ë ¤ë†“ê¸°",emoji:"ðŸ•Šï¸",focus:"detachment",keywords:["ì§‘ì°© ë‚´ë ¤ë†“ê¸°","ì‹¬ë¦¬ì  ê±°ë¦¬ë‘ê¸°"]},{id:"inner_voice",category:"growth",label:"ì™¸ë¶€ì˜ ì†ŒìŒì€ ë„ê³ , ë‚´ ì•ˆì˜ ëª©ì†Œë¦¬ì— ê·€ ê¸°ìš¸ì¼ëž˜ìš”",tag:"ëª°ìž…",emoji:"ðŸ§˜",focus:"sensation",keywords:["ê°ê° íšŒìˆ˜","ë‚´ë©´ ëª°ìž…","ê³ ìš”"]},{id:"self_compassion",category:"growth",label:"ì• ì“°ì§€ ì•Šê³ , ì§€ê¸ˆì˜ ë‚˜ë¥¼ ìžˆëŠ” ê·¸ëŒ€ë¡œ ì•ˆì•„ì¤„ëž˜ìš”",tag:"ìˆ˜ìš©",emoji:"ðŸ’š",focus:"acceptance",keywords:["ë¹„íŒë‹¨ì  ìˆ˜ìš©","ìžê¸° ì—°ë¯¼","í˜„ì¡´"]},{id:"energy_recharge",category:"growth",label:"ë°©ì „ëœ ì—ë„ˆì§€ë¥¼ ì±„ìš°ê³ , ë‹¤ì‹œ ë‚˜ì•„ê°ˆ íž˜ì„ ì–»ê³  ì‹¶ì–´ìš”",tag:"í™œë ¥",emoji:"âš¡",focus:"vitality",keywords:["ì—ë„ˆì§€ ìˆœí™˜","íšŒë³µ íƒ„ë ¥ì„±","ì˜ìš•"]},{id:"gratitude",category:"growth",label:"ë‹¹ì—°í–ˆë˜ ê²ƒë“¤ ì†ì—ì„œ ì†Œì¤‘í•œ ì˜ë¯¸ë¥¼ ë°œê²¬í•˜ê³  ì‹¶ì–´ìš”",tag:"ê°ì‚¬",emoji:"ðŸŒŸ",focus:"gratitude",keywords:["ê¸ì • íŽ¸í–¥","ê´€ê³„ì˜ ì—°ê²°","ìžì¡´ê°"]}],ue=[{id:"breath",label:"3ë¶„ ìˆ¨ ê³ ë¥´ê¸°",time:180,iconName:"Wind",color:"#48dbfb",desc:"ìž ê¹ì˜ í˜¸í¡ìœ¼ë¡œ ê· í˜• ì°¾ê¸°",freq:10},{id:"calm",label:"7ë¶„ ë§ˆìŒ ì •ëˆ",time:420,iconName:"Brain",color:"#FFD700",desc:"ííŠ¸ëŸ¬ì§„ ë§ˆìŒ ëŒë³´ê¸°",freq:8},{id:"deep",label:"15ë¶„ ê¹Šì€ ì´ì™„",time:900,iconName:"Sparkle",color:"#a29bfe",desc:"ê¹Šì€ ëª…ìƒì˜ ì„¸ê³„ë¡œ",freq:6}],Bt={v1:{id:"v1",label:"ì˜¨ëª¸ ì´ì™„ ê°€ì´ë“œ",desc:"ðŸ“± ê¸°ê¸° ìžìœ  Â· ìŒì„±ìœ¼ë¡œ íŽ¸ì•ˆí•˜ê²Œ ì•ˆë‚´",iconName:"Wind"},v2:{id:"v2",label:"í˜¸í¡ ëª°ìž…",desc:"ðŸŽ¤ ë§ˆì´í¬ ì‚¬ìš© Â· ìˆ¨ì†Œë¦¬ë¥¼ ê°ì§€í•´ ë°˜ì‘",iconName:"Microphone"},v3:{id:"v3",label:"ìžì„¸ êµì •",desc:"ðŸ“· ì¹´ë©”ë¼ í•„ìˆ˜ Â· ì „ì‹ ì´ ë³´ì´ê²Œ 2m ê±°ë¦¬",iconName:"VideoCamera"}},Le=[{id:"stress",label:"ë¨¸ë¦¬ê°€ ë³µìž¡í•´ìš”",iconName:"Lightning",color:"#FF6B6B",prescription:{modeId:"calm",type:"v2"}},{id:"stiff",label:"ëª¸ì´ ì°Œë¿Œë‘¥í•´ìš”",iconName:"Barbell",color:"#4ECDC4",prescription:{modeId:"breath",type:"v3"}},{id:"anxious",label:"ë§ˆìŒì´ ë¶ˆì•ˆí•´ìš”",iconName:"Heartbeat",color:"#FFD93D",prescription:{modeId:"deep",type:"v2"}},{id:"tired",label:"ë¬´ê¸°ë ¥í•´ìš”",iconName:"SmileySad",color:"#A8A4CE",prescription:{modeId:"calm",type:"v1"}},{id:"overthink",label:"ìƒê°ì´ ê¼¬ë¦¬ì— ê¼¬ë¦¬ë¥¼ ë¬¼ì–´ìš”",iconName:"Brain",color:"#a29bfe",prescription:{modeId:"calm",type:"v2"}},{id:"frustrated",label:"ê°€ìŠ´ì´ ë‹µë‹µí•´ìš”",iconName:"Wind",color:"#48dbfb",prescription:{modeId:"breath",type:"v2"}},{id:"low_energy",label:"ì—ë„ˆì§€ê°€ ë°”ë‹¥ë‚¬ì–´ìš”",iconName:"Sparkle",color:"#FFD32A",prescription:{modeId:"breath",type:"v1"}},{id:"distracted",label:"ì§‘ì¤‘ì´ ì•ˆ ë¼ìš”",iconName:"Lightning",color:"#32ff7e",prescription:{modeId:"calm",type:"v2"}}],pe=[{id:"sun",label:"ë§‘ìŒ",iconName:"Sun",color:"#FFD23F"},{id:"cloud",label:"íë¦¼",iconName:"Cloud",color:"#B0C4DE"},{id:"rain",label:"ë¹„",iconName:"CloudRain",color:"#4895EF"},{id:"snow",label:"ëˆˆ",iconName:"CloudSnow",color:"#A8E6CF"}],Dt=[{id:"none",label:"ì£¼íŒŒìˆ˜ë§Œ",desc:"ìˆœìˆ˜í•œ binaural beats",iconName:"Wind",color:"#48dbfb",audioUrl:null},{id:"rain",label:"ë¹—ì†Œë¦¬",desc:"ë¶€ë“œëŸ¬ìš´ ë¹—ì†Œë¦¬ì™€ í•¨ê»˜",iconName:"CloudRain",color:"#4895EF",audioUrl:"https://cdn.pixabay.com/download/audio/2022/03/15/audio_7e3e9d3f44.mp3?filename=rain-and-thunder-sounds-for-sleeping-black-screen-126699.mp3"},{id:"ocean",label:"íŒŒë„ì†Œë¦¬",desc:"ë°”ë‹¤ì˜ ë¦¬ë“¬ì— ë§¡ê¸°ê¸°",iconName:"Waves",color:"#00d2d3",audioUrl:"https://cdn.pixabay.com/download/audio/2022/03/24/audio_f0a69b3d97.mp3?filename=ocean-waves-112906.mp3"},{id:"forest",label:"ìˆ²ì† ìƒˆì†Œë¦¬",desc:"ìžì—°ì˜ í’ˆì—ì„œ ì‰¬ê¸°",iconName:"Plant",color:"#32ff7e",audioUrl:"https://cdn.pixabay.com/download/audio/2022/08/02/audio_884fe92c21.mp3?filename=forest-wind-and-birds-sounds-nature-sounds-8013.mp3"},{id:"singingbowl",label:"ì‹±ìž‰ë³¼",desc:"í‹°ë²³ ì‹±ìž‰ë³¼ì˜ ìš¸ë¦¼",iconName:"Sparkle",color:"#a29bfe",audioUrl:"https://cdn.pixabay.com/download/audio/2022/10/18/audio_69a97e72c8.mp3?filename=singing-bowl-sound-1-123051.mp3"}],Wt={v1:["íŽ¸ì•ˆí•œ ìžì„¸ë¥¼ ì°¾ì•„ë³´ì„¸ìš”. ì™„ë²½í•  í•„ìš” ì—†ì–´ìš”.","ì½”ë¡œ ì²œì²œížˆ ë“¤ì´ë§ˆì‹œê³ ... 4ì´ˆ... ì°¸ê³ ... 7ì´ˆ... ë‚´ì‰¬ê³ ... 8ì´ˆ...","ìƒê°ì´ ë– ì˜¤ë¥´ë©´ íŒë‹¨í•˜ì§€ ë§ê³  ê·¸ëƒ¥ ë°”ë¼ë³´ì„¸ìš”. êµ¬ë¦„ì²˜ëŸ¼ ì§€ë‚˜ê°ˆ ê±°ì˜ˆìš”.","ì–´ê¹¨ë¥¼ ê·€ì—ì„œ ë©€ë¦¬ ë–¨ì–´ëœ¨ë ¤ë³´ì„¸ìš”. ì•„, ê·¸ë ‡ì£ .","ì´ ìˆœê°„, ë‹¹ì‹ ì€ ì•„ë¬´ê²ƒë„ í•´ì•¼ í•  í•„ìš”ê°€ ì—†ì–´ìš”.","í˜¸í¡ì´ ë‹¹ì‹ ì„ ë°ë ¤ê°€ëŠ” ê³³ìœ¼ë¡œ ë”°ë¼ê°€ë³´ì„¸ìš”.","ì§€ê¸ˆ ì´ ê³µê°„ì€ ì•ˆì „í•´ìš”. ëª¨ë“  ê²ƒì„ ë‚´ë ¤ë†“ì•„ë„ ê´œì°®ì•„ìš”.","ë§¤ í˜¸í¡ë§ˆë‹¤ ê¸´ìž¥ì´ ì¡°ê¸ˆì”© ë…¹ì•„ë‚´ë¦¬ê³  ìžˆì–´ìš”.","ìž˜í•˜ê³  ìžˆì–´ìš”. ì´ ìˆœê°„ì— ìžˆëŠ” ê²ƒë§Œìœ¼ë¡œ ì¶©ë¶„í•´ìš”.","ë§ˆì§€ë§‰ìœ¼ë¡œ, ì˜¤ëŠ˜ í•˜ë£¨ ë‚˜ì—ê²Œ 'ìˆ˜ê³ í–ˆë‹¤'ê³  ë§í•´ì£¼ì„¸ìš”."],v2:["ë‹¹ì‹ ì˜ í˜¸í¡ ì†Œë¦¬ê°€ ë“¤ë ¤ìš”. ìžì—°ìŠ¤ëŸ¬ìš´ ë¦¬ë“¬ì´ë„¤ìš”.","ë‚´ì‰´ ë•Œë§ˆë‹¤ ì–´ê¹¨ê°€ ì¡°ê¸ˆì”© ë‚´ë ¤ê°€ëŠ” ê²ƒì„ ëŠê»´ë³´ì„¸ìš”.","í˜¸í¡ì´ ê¹Šì–´ì§€ê³  ìžˆì–´ìš”. ì¢‹ì€ ì‹ í˜¸ì˜ˆìš”.","ìˆ¨ì´ ë“¤ì–´ì˜¤ê³  ë‚˜ê°€ëŠ” ê·¸ ì‚¬ì´ì˜ ê³ ìš”í•¨ì„ ëŠê»´ë³´ì„¸ìš”.","ì§€ê¸ˆ í˜¸í¡ì€ íŒŒë„ì™€ ê°™ì•„ìš”. ë°€ë ¤ì˜¤ê³ , ë°€ë ¤ê°€ê³ .","ìˆ¨ì†Œë¦¬ ì™¸ì— ì•„ë¬´ê²ƒë„ ì‹ ê²½ ì“°ì§€ ì•Šì•„ë„ ë¼ìš”."],v3:["ìžì„¸ë¥¼ í™•ì¸í•´ë³¼ê²Œìš”. ì²™ì¶”ê°€ ìžì—°ìŠ¤ëŸ½ê²Œ íŽ´ì ¸ ìžˆë‚˜ìš”?","í„±ì„ ì‚´ì§ ë‹¹ê¸°ê³  ëª© ë’¤ë¥¼ ëŠ˜ë ¤ë³´ì„¸ìš”.","ì–´ê¹¨ê°€ ê·€ ìª½ìœ¼ë¡œ ì˜¬ë¼ê°”ë„¤ìš”. íˆ¬ìš± ë–¨ì–´ëœ¨ë ¤ë³´ì„¸ìš”.","ë¯¸ê°„ì— íž˜ì„ ë¹¼ë³´ì„¸ìš”. í‘œì •ì´ ë¶€ë“œëŸ¬ì›Œì¡Œì–´ìš”.","ì†ì€ íŽ¸í•˜ê²Œ ë¬´ë¦Ž ìœ„ì— ì˜¬ë ¤ë†“ìœ¼ì„¸ìš”.","ìžì„¸ê°€ ì•ˆì •ë˜ë‹ˆ í˜¸í¡ë„ ê¹Šì–´ì§€ë„¤ìš”."]},Sn=()=>{const[o,l]=n.useState(0),S=n.useRef(null),a=n.useRef(null),s=n.useRef(null),d=n.useRef(null),z=n.useCallback(function c(){if(!S.current)return;d.current=requestAnimationFrame(c),S.current.getByteTimeDomainData(a.current);let p=0;const E=a.current.length;for(let q=0;q<E;q++){const M=(a.current[q]-128)/128;p+=M*M}const V=Math.sqrt(p/E),N=Math.min(V*8,2.5);l(N)},[]),m=n.useCallback((c,p)=>{const E=p.createAnalyser(),V=p.createMediaStreamSource(c);V.connect(E),E.fftSize=1024,E.smoothingTimeConstant=.8;const N=E.frequencyBinCount,q=new Uint8Array(N);S.current=E,a.current=q,s.current=V,z()},[z]),D=n.useCallback(()=>{if(d.current&&cancelAnimationFrame(d.current),s.current){try{s.current.disconnect(),s.current.mediaStream&&s.current.mediaStream.getTracks().forEach(c=>c.stop())}catch(c){console.warn("Source disconnect failed",c)}s.current=null}l(0)},[]),W=n.useCallback(()=>{d.current&&cancelAnimationFrame(d.current)},[]),A=n.useCallback(()=>{z()},[z]);return{micVolume:o,setupAudioAnalysis:m,stopAudioAnalysis:D,pauseAudioAnalysis:W,resumeAudioAnalysis:A}},kn=(o,l,S,a,s,d,z)=>{const m=n.useRef(null),D=n.useRef(null),W=n.useRef(null),A=n.useRef(null),c=n.useRef(null),p=n.useRef(null),E=n.useCallback(()=>(m.current||(m.current=new(window.AudioContext||window.webkitAudioContext)),m.current),[]),V=n.useCallback((u=200,b=4,L=.25)=>{const y=E();y.state==="suspended"&&y.resume();const G=y.createOscillator(),F=y.createOscillator(),Q=y.createGain();G.type="sine",F.type="sine",G.frequency.value=u,F.frequency.value=u+b;const B=y.createStereoPanner(),xe=y.createStereoPanner();B.pan.value=-1,xe.pan.value=1,G.connect(B),B.connect(Q),F.connect(xe),xe.connect(Q),Q.connect(y.destination),Q.gain.value=L,G.start(),F.start(),D.current=G,W.current=F,A.current=Q,a&&a("BinauralBeats:Start",{carrierFreq:u,beatFreq:b,volume:L})},[E,a]),N=n.useCallback(()=>{if(D.current){try{D.current.stop()}catch{}D.current=null}if(W.current){try{W.current.stop()}catch{}W.current=null}A.current&&(A.current=null)},[]),q=n.useCallback(u=>{if(A.current&&m.current){const b=m.current.currentTime;A.current.gain.setTargetAtTime(u,b,.5)}},[]),M=n.useCallback(u=>{p.current&&(p.current.volume=u)},[]),P=n.useCallback((u,b)=>{if(!u||u.id==="none"){p.current&&(p.current.pause(),p.current=null);return}if(!p.current||!p.current.src.includes(u.file)){p.current&&p.current.pause();const L=new Audio(u.file);L.loop=!0,L.volume=b,p.current=L}p.current.play().catch(L=>{console.warn("Ambient play failed:",L),a&&a("Ambient:Error",L)})},[a]),h=n.useCallback(()=>{p.current&&p.current.pause()},[]),Y=n.useCallback(()=>{p.current&&(p.current.pause(),p.current.currentTime=0,p.current=null)},[]),j=n.useCallback(()=>{if(window.speechSynthesis&&window.speechSynthesis.cancel(),c.current){try{c.current.pause(),c.current.currentTime=0}catch{}c.current=null}},[]),re=n.useCallback((u,b,L)=>{if(!o||!u)return null;try{j();const y=new Audio(`data:audio/mp3;base64,${u}`);y.volume=b,c.current=y,s&&s({isSpeaking:!0,engine:"Cloud TTS",volume:y.volume}),a&&a("PlayAudio:Start",{vol:b}),y.onended=()=>{a&&a("PlayAudio:Ended"),s&&s(F=>({...F,isSpeaking:!1})),c.current===y&&(c.current=null),L&&L()};const G=y.play();return G!==void 0&&G.catch(F=>{console.error("ðŸ”Š Audio Playback Failed:",F),a&&a("PlayAudio:Error",F),s&&s(Q=>({...Q,isSpeaking:!1}))}),!l.current&&S==="session"&&(y.pause(),c.current=null),y}catch(y){return console.error("ðŸ”Š Audio Error:",y),a&&a("PlayAudio:Catch",y),s&&s(G=>({...G,isSpeaking:!1})),null}},[o,j,s,a,l,S]),$=n.useCallback(u=>{if(a&&a("Speak:Start",u),console.log("ðŸ—£ï¸ [TTS Check] Speaking:",u),!u||typeof window>"u"||!o||!window.speechSynthesis)return;j();const b=new SpeechSynthesisUtterance(u);b.lang="ko-KR",b.rate=.9,b.pitch=1,b.volume=.8,b.onstart=()=>s&&s({isSpeaking:!0,engine:"Local TTS",volume:.8}),b.onend=()=>s&&s(L=>({...L,isSpeaking:!1})),b.onerror=()=>s&&s(L=>({...L,isSpeaking:!1})),setTimeout(()=>{window.speechSynthesis&&o&&(S!=="session"||l.current)&&window.speechSynthesis.speak(b)},100)},[o,S,j,a,s,l]),se=n.useCallback(u=>{if(!u||typeof window>"u"||!o||!window.speechSynthesis)return;a&&a("SpeakFallback",u),j();const b=new SpeechSynthesisUtterance(u);b.lang="ko-KR",b.rate=.9,b.pitch=1,b.volume=.8,setTimeout(()=>{window.speechSynthesis&&o&&window.speechSynthesis.speak(b)},100)},[o,j,a]),he=n.useCallback((u=!1)=>{j(),u&&h(),N(),a&&a("StopAllAudio",{stopAmbient:u})},[j,h,N,a]);return n.useEffect(()=>()=>{m.current&&(m.current.close().catch(u=>console.error(u)),m.current=null)},[]),{audioContextRef:m,ambientAudioRef:p,currentAudioRef:c,getAudioContext:E,playBinauralBeats:V,stopBinauralBeats:N,updateBinauralVolume:q,playAmbientMusic:P,stopAmbientMusic:h,stopAmbientMusicAndReset:Y,updateAmbientVolume:M,playAudio:re,speak:$,speakFallback:se,stopVoiceOnly:j,stopAllAudio:he}},Ve=Pt($t,"generateMeditationGuidance"),In=Le[0],Cn=({memberName:o,timeContext:l,selectedIntention:S,activeMode:a,interactionType:s,micVolume:d,isPlayingRef:z,ttcEnabled:m,stopAllAudio:D,playAudio:W,speak:A,onExit:c,onMeditationReady:p})=>{const[E,V]=n.useState(!0),[N,q]=n.useState(!1),[M,P]=n.useState(0),[h,Y]=n.useState([]),[j,re]=n.useState(null),[$,se]=n.useState(""),[he,u]=n.useState(null),[b,L]=n.useState(""),[y,G]=n.useState(""),[F,Q]=n.useState(null),[B,xe]=n.useState(null),[oe,Ue]=n.useState(!1),ge=n.useRef(0),be=n.useRef(0),_e=n.useRef(null),ye=n.useRef(0),Se=n.useCallback(async(x,R,v,g,_)=>{try{const X=Date.now(),C=await Ve({type:"prescription",memberName:o,timeContext:l,weather:R,diagnosis:x,analysisSummary:_,mode:v==="breath"?"3min":v==="calm"?"7min":"15min",interactionType:g});P(Date.now()-X),C.data&&(C.data.prescriptionReason&&(C.data.prescriptionReason=C.data.prescriptionReason.replace(/OOë‹˜/g,`${o}ë‹˜`)),C.data.message&&(C.data.message=C.data.message.replace(/OOë‹˜/g,`${o}ë‹˜`)),u(C.data),L(C.data.prescriptionReason||C.data.message||""))}catch(X){console.error("Standalone Prescription fetch failed:",X)}},[o,l,P]),ae=n.useCallback(async(x=[])=>{if(N)return;q(!0),V(!0);const R=ge.current+1;ge.current=R;try{const v=new Date().getHours();let g="night";v>=5&&v<12?g="morning":v>=12&&v<18&&(g="afternoon");let _;const X=new Promise(Ye=>{_=setTimeout(()=>{const Ke=x&&x.length>0?"ìž ì‹œ ì—°ê²°ì´ ëŠ¦ì–´ì§€ë„¤ìš”. ê³„ì†í•´ì„œ ì´ì•¼ê¸° ë‚˜ëˆ ë³¼ê¹Œìš”?":"ì˜¤ëŠ˜ í•˜ë£¨ ë§ˆìŒì´ ì–´ë– ì…¨ë‚˜ìš”?",Ae=x&&x.length>0?["ë„¤, ì¢‹ì•„ìš”","ìž ì‹œ ìƒê°í• ê²Œìš”"]:["íŽ¸ì•ˆí•´ìš”","ê·¸ì € ê·¸ëž˜ìš”","ì§€ì³¤ì–´ìš”"];Ye({data:{message:Ke,isFinalAnalysis:!1,options:Ae,error:"timeout"}})},18e3)}),C=Date.now(),K=Ve({type:"question",memberName:o||"íšŒì›",timeContext:g,chatHistory:x,intentionFocus:S?.focus}),T=await Promise.race([K,X]);if(P(Date.now()-C),clearTimeout(_),R!==ge.current)return;T.data&&(T.data.message&&(T.data.message=T.data.message.replace(/OOë‹˜/g,`${o}ë‹˜`)),T.data.question&&(T.data.question=T.data.question.replace(/OOë‹˜/g,`${o}ë‹˜`)),T.data.isFinalAnalysis&&(T.data.options=[],T.data.isTransition=!0),re(T.data),T.data.audioContent?W(T.data.audioContent):T.data.isFinalAnalysis&&m&&A(T.data.message))}catch{if(R!==ge.current)return;re({message:"ì£„ì†¡í•´ìš”, ìž ì‹œ ì—°ê²°ì´ ê³ ë¥´ì§€ ì•Šë„¤ìš”. ê³„ì† ëŒ€í™”í•´ë³¼ê¹Œìš”?",options:["ë„¤, ì¢‹ì•„ìš”","ê·¸ëƒ¥ ì‹œìž‘í• ê²Œìš”"]})}finally{R===ge.current&&(V(!1),q(!1))}},[N,o,S,W,m,A,P]),ke=n.useCallback(async x=>{if(!x||N)return;if(D(),x==="í™ˆìœ¼ë¡œ ê°€ê¸°"){c&&c();return}if(j?.isFinalAnalysis||["ë„¤, ì‹œìž‘í• ê²Œìš”","ë§žì¶¤ ëª…ìƒ ì‹œìž‘í•˜ê¸°","ëª…ìƒí•˜ê³  ì‹¶ì–´ìš”","ì‹œìž‘í• ê²Œìš”","ëª…ìƒ ì‹œìž‘","ëª…ìƒ ì‹œìž‘í•˜ê¸°"].some(g=>x.includes(g))){const g=Le.find(X=>X.id===j?.mappedDiagnosis)||In,_=ue.find(X=>X.id===g?.prescription?.modeId)||ue[1];p&&p(g,_,g?.prescription?.type||"v1");return}D();let R=[...h];if(j){const g=j.message||j.question,_=g?.includes("ì—°ê²°ì´ ëŠ¦ì–´ì§€ë„¤ìš”")||g?.includes("ì—°ê²°ì´ ê³ ë¥´ì§€ ì•Šë„¤ìš”");g&&!_&&(R=[...R,{role:"model",content:g}])}j?.message?.includes("ì—°ê²°ì´ ëŠ¦ì–´ì§€ë„¤ìš”")||j?.message?.includes("ì—°ê²°ì´ ê³ ë¥´ì§€ ì•Šë„¤ìš”")||(R=[...R,{role:"user",content:x}]),Y(R),re(null),V(!0),await ae(R)},[N,j,h,D,c,p,ae]),Ie=n.useCallback(x=>{if(x.preventDefault(),!$.trim())return;const R=$;se(""),ke(R)},[$,ke]),Ee=n.useCallback(async()=>{V(!0);const x=`${o}ë‹˜, ë‹¤ì‹œ ëŒì•„ì˜¤ì…¨ë„¤ìš”. í˜¹ì‹œ ë” ë‚˜ëˆ„ê³  ì‹¶ì€ ì´ì•¼ê¸°ê°€ ìžˆìœ¼ì‹ ê°€ìš”?`;re({message:x,options:["ë„¤, ìžˆì–´ìš”","ê´œì°®ì•„ìš”, ëª…ìƒí• ê²Œìš”"]}),m&&A(x);const R=h.filter(g=>g.role==="user").pop()?.content||"",v=[...h,{role:"system",content:`[Context] User briefly viewed meditation options but chose to continue conversation. Last discussed: "${R}". Gently ask if they want to explore that topic more deeply, in a warm, human, conversational tone. Do NOT sound robotic or templated.`}];Y(v),await ae(v)},[o,h,m,A,ae]),Xe=n.useCallback(async()=>{try{const x=be.current,R=_e.current,v=Date.now();let g;const _=new Promise((K,T)=>{g=setTimeout(()=>T(new Error("Session AI timeout (8s)")),8e3)}),X=Ve({type:"session_message",memberName:o,timeContext:l,diagnosis:R,mode:a?.id==="breath"?"3min":a?.id==="calm"?"7min":"15min",interactionType:s,messageIndex:x,breathLevel:s==="v2"?d:null}),C=await Promise.race([X,_]);if(clearTimeout(g),P(Date.now()-v),C.data&&C.data.error)throw new Error("Backend Returned Error: "+C.data.error);if(C.data&&C.data.message){const K=C.data.message.replace(/OOë‹˜/g,`${o}ë‹˜`);z.current&&(G(K),be.current=x+1,ye.current=0,C.data.audioContent&&W(C.data.audioContent))}}catch(x){if(console.error("AI Session message failed:",x.message),z.current){const R=be.current;if(ye.current+=1,ye.current>3)return;const g=Wt[s]||Wt.v1,_=g[R%g.length];G(_),be.current=R+1}}},[o,l,a,s,d,z,W,P]),Ne=n.useCallback(async(x,R)=>{try{const v=await Ve({type:"feedback",memberName:o,sessionInfo:F,postureFeedback:R,stabilityScore:x});return v.data&&v.data.feedbackMessage&&xe({message:v.data.feedbackMessage.replace(/OOë‹˜/g,`${o}ë‹˜`),analysis:v.data.analysis}),v.data}catch(v){return console.error("AI Feedback Failed:",v),null}},[o,F]),O=n.useCallback((x,R,v)=>{const g=x==="morning"?"í•˜ë£¨ë¥¼ ì‹œìž‘í•˜ëŠ” ì•„ì¹¨,":x==="afternoon"?"ì—ë„ˆì§€ê°€ í•„ìš”í•œ ì˜¤í›„,":"í•˜ë£¨ë¥¼ ì •ë¦¬í•˜ëŠ” ë°¤,";let _="ë‹¹ì‹ ì˜ ì§€ê¸ˆ ìƒíƒœì— ë”± ë§žëŠ” ëª…ìƒì„ ì¤€ë¹„í–ˆì–´ìš”. ë§ˆìŒì˜ ì†Œë¦¬ì— ê·€ë¥¼ ê¸°ìš¸ì´ë©° íŽ¸ì•ˆí•˜ê²Œ ì‹œìž‘í•´ë³¼ê¹Œìš”?";return v==="stress"||v==="overthink"?_="ë³µìž¡í•œ ìƒê°ì€ ë‡Œì˜ ë² íƒ€íŒŒ ê³¼ìž‰ ìƒíƒœì¼ ìˆ˜ ìžˆì–´ìš”. ì§€ê¸ˆ ì´ ìˆœê°„, ëª¨ë“  íŒë‹¨ì„ ë©ˆì¶”ê³  ì œ ì•ˆë‚´ë¥¼ ë”°ë¼ í˜¸í¡ì˜ íŒŒë„ì— ëª¸ì„ ë§¡ê²¨ë³´ì„¸ìš”. ê³§ ë¨¸ë¦¿ì†ì´ ë§‘ì•„ì§ˆ ê±°ì˜ˆìš”.":v==="stiff"?_="ëª¸ì˜ ê¸´ìž¥ì€ ë§ˆìŒì´ ë³´ë‚´ëŠ” ì‹ í˜¸ì˜ˆìš”. êµ³ì–´ìžˆë˜ ê·¼ìœ¡ì„ ì˜ì‹ì ìœ¼ë¡œ ì´ì™„í•˜ë©° í˜¸í¡í•˜ë©´, ë§‰í˜”ë˜ ì—ë„ˆì§€ê°€ íë¥´ê¸° ì‹œìž‘í•  ê±°ì˜ˆìš”.":v==="anxious"||v==="frustrated"?_="ë‹µë‹µí•˜ê³  ë¶ˆì•ˆí•œ ë§ˆìŒì€ ëˆ„êµ¬ë‚˜ ê°€ì§ˆ ìˆ˜ ìžˆëŠ” êµ¬ë¦„ ê°™ì€ ê±°ì˜ˆìš”. ê·¸ êµ¬ë¦„ ë’¤ì— ìžˆëŠ” ë§‘ì€ í•˜ëŠ˜ì„ ë³¼ ìˆ˜ ìžˆë„ë¡ ì œê°€ ê³ì—ì„œ ë„ì™€ë“œë¦´ê²Œìš”. ë‹¹ì‹ ì€ ì•ˆì „í•©ë‹ˆë‹¤.":v==="tired"||v==="low_energy"?_="ì—ë„ˆì§€ê°€ ë¶€ì¡±í•  ë•ŒëŠ” ì–µì§€ë¡œ ë…¸ë ¥í•  í•„ìš” ì—†ì–´ìš”. ê·¸ì € íŽ¸ì•ˆížˆ ì•‰ì•„ ìžˆëŠ” ê²ƒë§Œìœ¼ë¡œë„ ì¶©ë¶„í•œ ëª…ìƒì´ ë©ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì§€ì¹œ ë§ˆìŒì„ ë”°ëœ»í•˜ê²Œ ì•ˆì•„ì¤„ê²Œìš”.":v==="distracted"&&(_="í©ì–´ì§„ ë§ˆìŒì„ í•˜ë‚˜ë¡œ ëª¨ìœ¼ëŠ” ì—°ìŠµì„ í•´ë³¼ê¹Œìš”? í˜¸í¡ì´ë¼ëŠ” ë‹»ì„ ë‚´ë¦¬ê³  'ì§€ê¸ˆ ì—¬ê¸°'ë¡œ ëŒì•„ì˜¤ëŠ” ì—¬ì •ì„ ì‹œìž‘í•´ë´ìš”."),`${g} ${_}`},[]);return{isAILoading:E,setIsAILoading:V,aiRequestLock:N,setAiRequestLock:q,aiLatency:M,setAiLatency:P,chatHistory:h,setChatHistory:Y,currentAIChat:j,setCurrentAIChat:re,manualInput:$,setManualInput:se,aiPrescription:he,setAiPrescription:u,prescriptionReason:b,setPrescriptionReason:L,aiMessage:y,setAiMessage:G,sessionInfo:F,setSessionInfo:Q,feedbackData:B,setFeedbackData:xe,needsFeedback:oe,setNeedsFeedback:Ue,messageIndexRef:be,sessionDiagnosisRef:_e,consecutiveFailsRef:ye,fetchAIPrescription:Se,fetchAIQuestion:ae,fetchAISessionMessage:Xe,fetchAIFeedback:Ne,handleChatResponse:ke,handleManualSubmit:Ie,handleReturnToChat:Ee,generateReason:O}},An=()=>{const[o,l]=n.useState(null),S=n.useCallback(async()=>{try{navigator.geolocation?navigator.geolocation.getCurrentPosition(async a=>{const{latitude:s,longitude:d}=a.coords;try{const m=await(await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${s}&lon=${d}&appid=bd5e378503939ddaee76f12ad7a97608&units=metric`)).json(),D=m.weather?.[0]?.main?.toLowerCase()||"",W=m.weather?.[0]?.description||"";let A=pe[0];D.includes("rain")||D.includes("drizzle")?A=pe.find(p=>p.id==="rain"):D.includes("snow")?A=pe.find(p=>p.id==="snow"):(D.includes("cloud")||D.includes("mist")||D.includes("fog"))&&(A=pe.find(p=>p.id==="cloud"));const c={...A,temp:Math.round(m.main?.temp)||20,humidity:m.main?.humidity||50,windSpeed:Math.round((m.wind?.speed||0)*3.6),description:W,feelsLike:Math.round(m.main?.feels_like)||20,city:m.name||"ì„œìš¸"};l(c),console.log("ðŸŒ¤ï¸ Full Weather:",c)}catch(z){console.error("Weather API failed:",z),l({...pe[0],temp:20,humidity:50,windSpeed:5})}},()=>{l({...pe[0],temp:20,humidity:50,windSpeed:5})},{timeout:5e3}):l({...pe[0],temp:20,humidity:50,windSpeed:5})}catch(a){console.error("Weather detection failed:",a),l({...pe[0],temp:20,humidity:50,windSpeed:5})}},[]);return{weatherContext:o,setWeatherContext:l,detectWeather:S}},{Brain:Mt}=Ge,Ft=["ë§ˆìŒì„ ì—°ê²°í•˜ê³  ìžˆì–´ìš”...","ê¹Šì´ ë¶„ì„ ì¤‘ìž…ë‹ˆë‹¤...","ì˜¤ëŠ˜ì˜ ë‹¹ì‹ ì„ ì´í•´í•˜ê³  ìžˆì–´ìš”...","í˜¸í¡ì— ì§‘ì¤‘í•´ ë³´ì„¸ìš”...","ìž ì‹œ, ê³ ìš”í•¨ ì†ì— ë¨¸ë¬¼ëŸ¬ìš”..."],Lt=({compact:o=!1,message:l=null})=>{const[S,a]=n.useState(0);n.useEffect(()=>{if(l)return;const d=setInterval(()=>{a(z=>(z+1)%Ft.length)},2500);return()=>clearInterval(d)},[l]);const s=l||Ft[S];return o?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 20px",borderRadius:"20px",background:"rgba(212, 175, 55, 0.08)",border:"1px solid rgba(212, 175, 55, 0.15)"},children:[e.jsx("div",{className:"ai-thinking-icon",style:{width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--primary-gold, #d4af37)"},children:e.jsx(Mt,{size:24,weight:"duotone"})}),e.jsx("span",{style:{color:"rgba(255,255,255,0.8)",fontSize:"0.9rem"},children:s})]}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"24px",padding:"40px"},children:[e.jsx("div",{className:"ai-thinking-icon",style:{width:"80px",height:"80px",borderRadius:"50%",background:"rgba(212, 175, 55, 0.1)",border:"2px solid rgba(212, 175, 55, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--primary-gold, #d4af37)",boxShadow:"0 0 30px rgba(212, 175, 55, 0.2)"},children:e.jsx(Mt,{size:40,weight:"duotone"})}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{color:"rgba(255,255,255,0.9)",fontSize:"1.1rem",fontWeight:"500",marginBottom:"8px",transition:"opacity 0.3s ease"},children:s}),e.jsx("div",{style:{color:"rgba(255,255,255,0.4)",fontSize:"0.85rem"},children:"ë³µìˆœì´ê°€ ìƒê°í•˜ê³  ìžˆì–´ìš”"})]})]})},{X:zn}=Ge,Rn=({showVolumePanel:o,setShowVolumePanel:l,audioVolumes:S,setAudioVolumes:a,currentAudioRef:s,updateAmbientVolume:d,updateBinauralVolume:z,soundEnabled:m,setSoundEnabled:D})=>o?e.jsxs("div",{style:{position:"absolute",bottom:"180px",left:"50%",transform:"translateX(-50%)",width:"280px",background:"rgba(0,0,0,0.85)",backdropFilter:"blur(20px)",borderRadius:"24px",padding:"20px",zIndex:30,border:"1px solid rgba(255,255,255,0.15)",boxShadow:"0 20px 60px rgba(0,0,0,0.6)",animation:"fadeIn 0.3s ease"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[e.jsx("span",{style:{color:"var(--primary-gold)",fontSize:"0.85rem",fontWeight:700},children:"ðŸŽ›ï¸ ë³¼ë¥¨ ì¡°ì ˆ"}),e.jsx("button",{onClick:()=>l(!1),style:{background:"none",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer",padding:"4px"},children:e.jsx(zn,{size:18})})]}),e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[e.jsx("span",{style:{fontSize:"0.8rem",color:"rgba(255,255,255,0.7)"},children:"ðŸ—£ï¸ ìŒì„± ì•ˆë‚´"}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--primary-gold)"},children:[Math.round(S.voice*100),"%"]})]}),e.jsx("input",{type:"range",min:"0",max:"100",value:Math.round(S.voice*100),onChange:W=>{const A=parseInt(W.target.value)/100;a(c=>({...c,voice:A})),s.current&&(s.current.volume=A)},style:{width:"100%",accentColor:"var(--primary-gold)",height:"4px"}})]}),e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[e.jsx("span",{style:{fontSize:"0.8rem",color:"rgba(255,255,255,0.7)"},children:"ðŸŒŠ í™˜ê²½ìŒ"}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--primary-gold)"},children:[Math.round(S.ambient*100),"%"]})]}),e.jsx("input",{type:"range",min:"0",max:"100",value:Math.round(S.ambient*100),onChange:W=>{const A=parseInt(W.target.value)/100;a(c=>({...c,ambient:A})),d(A)},style:{width:"100%",accentColor:"#4ade80",height:"4px"}})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[e.jsx("span",{style:{fontSize:"0.8rem",color:"rgba(255,255,255,0.7)"},children:"ðŸŽµ ì£¼íŒŒìˆ˜"}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--primary-gold)"},children:[Math.round(S.binaural*100),"%"]})]}),e.jsx("input",{type:"range",min:"0",max:"100",value:Math.round(S.binaural*100),onChange:W=>{const A=parseInt(W.target.value)/100;a(c=>({...c,binaural:A})),z(A)},style:{width:"100%",accentColor:"#a29bfe",height:"4px"}})]}),e.jsx("button",{onClick:()=>{D(!m),m?(d(0),z(0)):(d(S.ambient),z(S.binaural))},style:{marginTop:"12px",width:"100%",padding:"10px",borderRadius:"12px",background:m?"rgba(255,255,255,0.08)":"rgba(255,0,0,0.15)",border:"1px solid rgba(255,255,255,0.1)",color:m?"rgba(255,255,255,0.7)":"#ff6b6b",fontSize:"0.8rem",cursor:"pointer",fontWeight:600},children:m?"ðŸ”‡ ì „ì²´ ìŒì†Œê±°":"ðŸ”Š ì†Œë¦¬ ì¼œê¸°"})]}):null,{X:Tn,Heartbeat:Bn,Brain:Dn}=Ge,Wn=({activeMode:o,feedbackData:l,formatTime:S,timeLeft:a,modeName:s,onClose:d})=>{Ot();const m=(o?.id==="breath"?180:o?.id==="calm"?420:900)-a;return e.jsxs("div",{style:{position:"fixed",inset:0,background:"#0a0a0c",zIndex:4e3,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px",overflowY:"auto"},children:[e.jsx("button",{onClick:d,style:{position:"absolute",top:"20px",right:"20px",background:"rgba(255,255,255,0.1)",border:"none",color:"white",width:"50px",height:"50px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:e.jsx(Tn,{size:24})}),e.jsxs("div",{style:{background:"linear-gradient(145deg, rgba(30,30,35,0.9), rgba(15,15,20,0.9))",borderRadius:"30px",padding:"40px",maxWidth:"600px",width:"100%",border:`1px solid ${o?.color}40`,boxShadow:`0 20px 80px ${o?.color}20`,animation:"fadeIn 0.5s ease-out"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"30px"},children:[e.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:`${o?.color}20`,margin:"0 auto 20px",display:"flex",alignItems:"center",justifyContent:"center",color:o?.color},children:e.jsx(Dn,{size:40,weight:"light"})}),e.jsx("h2",{style:{color:"white",fontSize:"1.8rem",fontWeight:600,marginBottom:"10px"},children:"ëª…ìƒ ìˆ˜ë ¨ ì™„ë£Œ"}),e.jsxs("p",{style:{color:"rgba(255,255,255,0.6)",fontSize:"1.1rem"},children:[s," â€¢ ",Math.floor(m/60),"ë¶„ ",m%60,"ì´ˆ ìˆ˜ë ¨"]})]}),l?e.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",borderRadius:"20px",padding:"25px",border:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"15px"},children:[e.jsx(Bn,{size:24,color:o?.color}),e.jsx("h3",{style:{color:"white",fontSize:"1.2rem",fontWeight:500,margin:0},children:"ë³µìˆœì´ì˜ ë§ˆìŒ ê´€ì°° ì¼ì§€"})]}),e.jsx("p",{style:{color:"rgba(255,255,255,0.9)",lineHeight:1.8,fontSize:"1.1rem",whiteSpace:"pre-wrap"},children:l.message}),l.analysis&&e.jsxs("div",{style:{marginTop:"20px",paddingTop:"20px",borderTop:"1px solid rgba(255,255,255,0.1)",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"15px",borderRadius:"15px"},children:[e.jsx("span",{style:{display:"block",color:"rgba(255,255,255,0.5)",fontSize:"0.85rem",marginBottom:"5px"},children:"í˜¸í¡ ì•ˆì •ë„"}),e.jsxs("span",{style:{color:"white",fontSize:"1.2rem",fontWeight:600},children:[l.analysis.stabilityScore,"/100"]})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"15px",borderRadius:"15px"},children:[e.jsx("span",{style:{display:"block",color:"rgba(255,255,255,0.5)",fontSize:"0.85rem",marginBottom:"5px"},children:"ì—ë„ˆì§€ ë³€í™”"}),e.jsx("span",{style:{color:"white",fontSize:"1.1rem",fontWeight:500},children:l.analysis.energyShift})]})]})]}):e.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[e.jsx("div",{className:"breathing-circle",style:{width:"40px",height:"40px",margin:"0 auto 20px",background:o?.color,borderRadius:"50%"}}),e.jsx("p",{style:{color:"rgba(255,255,255,0.6)"},children:"ëª…ìƒ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  ìžˆìŠµë‹ˆë‹¤..."})]}),e.jsx("button",{onClick:d,style:{width:"100%",padding:"20px",marginTop:"30px",background:o?.color,border:"none",borderRadius:"15px",color:"#000",fontSize:"1.2rem",fontWeight:600,cursor:"pointer",boxShadow:`0 10px 30px ${o?.color}40`},children:"ë§ˆìŒ ì±™ê¹€ ë§ˆì¹˜ê³  ëŒì•„ê°€ê¸°"})]})]})},ie=({isVisible:o,ttsState:l,currentStep:S,audioLevels:a,currentText:s,aiLatency:d})=>o?e.jsxs("div",{style:{position:"fixed",top:"80px",left:"20px",right:"20px",background:"rgba(0,0,0,0.85)",backdropFilter:"blur(10px)",border:"1px solid rgba(0,255,255,0.3)",borderRadius:"15px",padding:"15px",color:"#00ffff",fontSize:"0.75rem",zIndex:1e4,fontFamily:"monospace",pointerEvents:"none",boxShadow:"0 10px 30px rgba(0,0,0,0.5)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",borderBottom:"1px solid rgba(0,255,255,0.2)",paddingBottom:"4px",display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"[MEDITATION DEBUG MODE]"}),e.jsxs("span",{children:["Latency: ",d,"ms"]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"#fff",marginBottom:"4px"},children:"ðŸ“¡ AI & Step Status"}),e.jsxs("div",{children:["Step: ",S]}),e.jsxs("div",{children:["TTS Engine: ",l.engine]}),e.jsxs("div",{children:["Speaking: ",l.isSpeaking?"YES":"NO"]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#fff",marginBottom:"4px"},children:"ðŸ”Š Audio Levels"}),e.jsxs("div",{children:["Voice: ",Math.round(a.voice*100),"%"]}),e.jsxs("div",{children:["Ambient: ",Math.round(a.ambient*100),"%"]}),e.jsxs("div",{children:["Binaural: ",Math.round(a.binaural*100),"%"]})]})]}),e.jsxs("div",{style:{marginTop:"10px",paddingTop:"8px",borderTop:"1px solid rgba(0,255,255,0.1)"},children:[e.jsx("div",{style:{color:"#fff",marginBottom:"4px"},children:"ðŸ“ Raw TTS Text:"}),e.jsx("div",{style:{background:"rgba(0,0,0,0.3)",padding:"6px",borderRadius:"4px",maxHeight:"60px",overflowY:"auto",whiteSpace:"pre-wrap"},children:s||"No text currently processed"})]})]}):null,{Play:_t,Pause:Mn,X:Et,Wind:Ht,SpeakerHigh:Me,SpeakerSlash:Fn,Brain:Vt,Microphone:ct,VideoCamera:qt,LockKey:Ln,Heartbeat:_n,SmileySad:En,Lightning:Nn,Barbell:Pn,Sparkle:Gt,Sun:$n,CloudRain:On,CloudSnow:Hn,Cloud:Vn}=Ge,Fe=({size:o=24,color:l="currentColor"})=>e.jsx("svg",{width:o,height:o,viewBox:"0 0 256 256",fill:l,children:e.jsx("path",{d:"M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"})}),qn=({size:o=24,color:l="currentColor"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:o,height:o,fill:l,viewBox:"0 0 256 256",children:e.jsx("path",{d:"M213.66,122.34a8,8,0,0,1-11.32,0L136,56v152a8,8,0,0,1-16,0V56L53.66,122.34a8,8,0,0,1-11.32-11.32l80-80a8,8,0,0,1,11.32,0l80,80A8,8,0,0,1,213.66,122.34Z"})}),Nt={Wind:Ht,Brain:Vt,Sparkle:Gt,Microphone:ct,VideoCamera:qt,Lightning:Nn,Barbell:Pn,Heartbeat:_n,SmileySad:En,Sun:$n,CloudRain:On,CloudSnow:Hn,Cloud:Vn},qe=Pt($t,"generateMeditationGuidance"),Gn=Le[0],Qn=({onClose:o})=>{const l=Ot(),S=n.useRef(null),a=n.useRef(!1),[s,d]=n.useState("initial_prep"),[z,m]=n.useState("morning"),{weatherContext:D,setWeatherContext:W,detectWeather:A}=An(),[c,p]=n.useState(null),[E,V]=n.useState(null),[N,q]=n.useState(null),[M,P]=n.useState(null),[h,Y]=n.useState("v1"),[j,re]=n.useState("heartbeat");n.useEffect(()=>{const i=["heartbeat","candle","rain","snow"],t=i[Math.floor(Math.random()*i.length)];re(t),console.log(`ðŸŽ¨ [Visual Theme] Selected: ${t}`)},[]);const[$,se]=n.useState(!1),[he,u]=n.useState(0),[b,L]=n.useState(!0),[y,G]=n.useState(!0),[F,Q]=n.useState("rain"),[B,xe]=n.useState({voice:.8,ambient:.35,binaural:.1}),{micVolume:oe,setupAudioAnalysis:Ue,stopAudioAnalysis:ge,pauseAudioAnalysis:be,resumeAudioAnalysis:_e}=Sn(),[ye,Se]=n.useState(null),[ae,ke]=n.useState(null),[Ie,Ee]=n.useState(!1),[Xe,Ne]=n.useState(!1),[O]=n.useState(()=>{try{const i=localStorage.getItem("member");if(i)return JSON.parse(i).name||"íšŒì›"}catch(i){console.warn("Failed to load member name",i)}return"íšŒì›"}),[x,R]=n.useState(!1),[,v]=n.useState(0),[g,_]=n.useState({isSpeaking:!1,engine:"None",volume:0}),X=n.useCallback(()=>{v(i=>{const t=i+1;return t>=5?(R(r=>!r),0):t})},[]),C=n.useCallback((i,t)=>{const r=new Date().toLocaleTimeString();console.log(`%c[MeditationDebug] ${r} [${i}]`,"color: #00ffff; font-weight: bold;",t||"")},[]),{audioContextRef:K,currentAudioRef:T,getAudioContext:Ye,playBinauralBeats:Ke,updateBinauralVolume:Ae,playAmbientMusic:dt,stopAmbientMusic:pt,updateAmbientVolume:Je,playAudio:ze,speak:le,speakFallback:Qe,stopAllAudio:ce}=kn(y,a,s,C,_),{isAILoading:ne,setIsAILoading:Re,setAiRequestLock:Ut,aiLatency:Z,setAiLatency:ut,chatHistory:fe,setChatHistory:Pe,currentAIChat:H,setCurrentAIChat:xt,manualInput:$e,setManualInput:Xt,prescriptionReason:Ze,setPrescriptionReason:et,aiMessage:J,setAiMessage:Oe,sessionInfo:Te,setSessionInfo:Yt,feedbackData:gt,setFeedbackData:ft,needsFeedback:tt,setNeedsFeedback:mt,messageIndexRef:Kt,sessionDiagnosisRef:Jt,consecutiveFailsRef:ht,fetchAIPrescription:nt,fetchAIQuestion:bt,fetchAISessionMessage:it,handleChatResponse:Qt,handleManualSubmit:Zt,handleReturnToChat:en,generateReason:yt}=Cn({memberName:O,timeContext:z,selectedIntention:E,activeMode:M,interactionType:h,micVolume:oe,isPlayingRef:a,ttcEnabled:y,stopAllAudio:ce,playAudio:ze,speak:le,onExit:()=>{ce(),o?o():l("/")},onMeditationReady:(i,t,r)=>{ce(),p(i),P(t),u(t.time),Y(r),d("interaction_select")}}),[tn,Un]=n.useState(""),[nn,rn]=n.useState(Rt),[sn,on]=n.useState(Tt),[an,ln]=n.useState(!0),[ve,Be]=n.useState(1);n.useEffect(()=>{C("StepChange",{step:s,prepStep:ve})},[s,ve]);const[me,rt]=n.useState({notified:!1,posture:"chair",goal:null});n.useEffect(()=>{C("Mount",{step:s,prepStep:ve}),(async()=>{try{const t=new Date().getHours(),r=t>=5&&t<11?"morning":t>=18||t<5?"evening":"day";m(r),C("TimeContext",{tCtx:r}),C("FetchOptions:Start");const w=Date.now(),I=await qe({type:"options_refresh",timeContext:r,weather:"unknown"});if(ut(Date.now()-w),C("FetchOptions:Result",I.data),I.data){if(I.data.categories&&Array.isArray(I.data.categories)){const f=Rt.map(k=>{const U=I.data.categories.find(te=>te.id===k.id);return U?{...k,label:U.label,description:U.description}:k});rn(f)}if(I.data.intentions&&Array.isArray(I.data.intentions)){const f=Tt.map(k=>{const U=I.data.intentions.find(te=>te.id===k.id);return U?{...k,label:U.label}:k});on(f)}}}catch(t){console.error("Failed to fetch dynamic options:",t),C("FetchOptions:Error",t)}finally{setTimeout(()=>ln(!1),2e3)}})()},[]);const[,cn]=n.useState(null),[,vt]=n.useState(!1),[,dn]=n.useState(100),st=n.useRef(null),je=n.useRef(null),De=n.useRef(null),de=n.useRef(null),ee=n.useRef(null),ot=n.useRef(null),Ce=n.useCallback((i=!1)=>{T.current&&(T.current.pause(),T.current.currentTime=0,T.current=null),clearInterval(De.current),clearInterval(de.current),ge(),ce(i),S.current&&(S.current.getTracks().forEach(I=>I.stop()),S.current=null,ke(null)),K.current&&(K.current.close().catch(I=>console.error(I)),K.current=null),je.current&&(je.current.close(),je.current=null);const t=M,r=c,w=t?t.time-he:0;se(!1),a.current=!1,d("diagnosis"),Be(1),t&&Yt({mode:t.id,modeName:t.label,duration:w,diagnosis:r?.id}),P(null),p(null),V(null),q(null),Pe([]),Re(!1),mt(!0),console.log("ðŸ›‘ stopSession: needsFeedback set to true, step to diagnosis"),Oe(""),et(""),W(null),window.speechSynthesis&&window.speechSynthesis.cancel()},[M,c,he,ge]),We=n.useRef([]),He=n.useRef(new Set),jt=n.useCallback(i=>{if(!i.poseLandmarks||!st.current||!ee.current)return;const t=st.current,r=t.getContext("2d"),{width:w,height:I}=t;r.clearRect(0,0,w,I),r.strokeStyle="#d4af37",r.lineWidth=4,r.lineJoin="round",r.lineCap="round",r.shadowBlur=10,r.shadowColor="rgba(212, 175, 55, 0.5)";const f=(te,we)=>{!te||!we||te.visibility<.5||we.visibility<.5||(r.beginPath(),r.moveTo(te.x*w,te.y*I),r.lineTo(we.x*w,we.y*I),r.stroke())},k=i.poseLandmarks;f(k[11],k[12]),f(k[11],k[23]),f(k[12],k[24]),f(k[23],k[24]),f(k[11],k[13]),f(k[13],k[15]),f(k[12],k[14]),f(k[14],k[16]);const U=k[0];if(U&&U.visibility>.5&&(r.beginPath(),r.arc(U.x*w,U.y*I,10,0,2*Math.PI),r.stroke()),U&&k[11]&&k[12]){const te=k[11],we=k[12],Ct=(te.x+we.x)/2,At=Math.abs(U.x-Ct),vn=(te.y+we.y)/2,jn=Math.abs(U.y-vn);let zt=Math.max(0,100-At*500);At>.08&&(U.x<Ct?He.current.add("leaning_right"):He.current.add("leaning_left")),jn<.15&&He.current.add("head_drop"),dn(wn=>Math.round(wn*.9+zt*.1)),We.current.push({score:zt,timestamp:Date.now()}),We.current.length>1e3&&We.current.shift()}cn(k)},[]),pn=n.useCallback(async()=>{if(!(!ee.current||je.current)){vt(!0);try{console.log("â³ Loading AI Libraries Dynamically...");const[{Pose:i},t,r]=await Promise.all([lt(()=>import("./pose-C7hUOr9t-v7.js").then(f=>f.p),__vite__mapDeps([0,1,2])),lt(()=>import("./index-GNeIC8lQ-v7.js").then(f=>f.dN),__vite__mapDeps([3,1,2])),lt(()=>import("./index-GAKaKZnS-v7.js"),__vite__mapDeps([4,3,1,2]))]);console.log("âœ… AI Libraries Loaded!");const w=new i({locateFile:f=>`https://cdn.jsdelivr.net/npm/@mediapipe/pose@latest/${f}`});w.setOptions({modelComplexity:1,smoothLandmarks:!0,enableSegmentation:!1,minDetectionConfidence:.5,minTrackingConfidence:.5}),w.onResults(jt),je.current=w;const I=async()=>{ee.current&&je.current&&$&&(await je.current.send({image:ee.current}),$&&requestAnimationFrame(I))};I()}catch(i){console.error("âŒ Failed to load AI libraries:",i),Se("AI ì—”ì§„ ë¡œë”©ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.")}finally{vt(!1)}}},[jt,$]),un=n.useRef(null);un.current=()=>{if(typeof window<"u"&&window.speechSynthesis&&window.speechSynthesis.cancel(),T.current){try{T.current.pause(),T.current.currentTime=0}catch{}T.current=null}},n.useEffect(()=>{const i=new Date().getHours();let t="morning";return i>=5&&i<12?t="morning":i>=12&&i<18?t="afternoon":t="night",m(t),A(),()=>{Ce()}},[Ce]),n.useEffect(()=>{s==="diagnosis"&&fe.length===0&&!H&&bt()},[s,fe.length]),n.useEffect(()=>{if(console.log(`ðŸ” Feedback Effect check: step=${s}, needsFeedback=${tt}`),s==="diagnosis"&&tt){console.log("ðŸŽ¯ Session Ended - Injecting Feedback Greeting for:",O);const i=new Date().getHours();let t;i>=5&&i<12?t=`${O}ë‹˜, ì•„ì¹¨ ëª…ìƒì€ ì–´ë– ì…¨ë‚˜ìš”? ìƒì¾Œí•œ í•˜ë£¨ë¥¼ ì‹œìž‘í•˜ëŠ” ë° ë„ì›€ì´ ë˜ì…¨ê¸¸ ë°”ë¼ìš”. ë” ë‚˜ëˆ„ê³  ì‹¶ì€ ì´ì•¼ê¸°ê°€ ìžˆìœ¼ì‹ ê°€ìš”?`:i>=12&&i<18?t=`${O}ë‹˜, ëª…ìƒì€ ì–´ë– ì…¨ë‚˜ìš”? ì˜¤í›„ ì‹œê°„ì´ ì¡°ê¸ˆ ë” íŽ¸ì•ˆí•´ì§€ì…¨ê¸¸ ë°”ë¼ìš”. ë” ë‚˜ëˆ„ê³  ì‹¶ì€ ì´ì•¼ê¸°ê°€ ìžˆìœ¼ì‹ ê°€ìš”?`:t=`${O}ë‹˜, ì˜¤ëŠ˜ì˜ ëª…ìƒì€ ì–´ë– ì…¨ë‚˜ìš”? íŽ¸ì•ˆí•œ ë°¤ ë˜ì‹œê¸¸ ë°”ë¼ìš”. ë” ë‚˜ëˆ„ê³  ì‹¶ì€ ì´ì•¼ê¸°ê°€ ìžˆìœ¼ì‹ ê°€ìš”?`,Ut(!1),Re(!1),xt({message:t,options:["ë„¤, ë” ì´ì•¼ê¸°í• ëž˜ìš”","ì¶©ë¶„í•´ìš”, ì¢…ë£Œí• ê²Œìš”"]}),Te?(async()=>{try{const r=await qe({type:"feedback_message",memberName:O,timeContext:z,modeName:Te.modeName,duration:Te.duration,diagnosis:Te.diagnosis});if(r.data?.message){const w=r.data.message.replace(/OOë‹˜/g,`${O}ë‹˜`);xt({message:w,options:["í™ˆìœ¼ë¡œ ê°€ê¸°"]}),r.data.audioContent?ze(r.data.audioContent):y&&le(w)}}catch(r){console.error("Feedback message AI failed, using fallback:",r),y&&Qe(t)}})():y&&Qe(t),mt(!1)}},[s,tt,y,Qe,O,Te,z,ze,le]),n.useEffect(()=>{ae&&ee.current&&(ee.current.srcObject=ae)},[ae]),n.useEffect(()=>{Ae(b?B.binaural:0),Je(b?B.ambient:0)},[b,B,Ae,Je]),n.useEffect(()=>{if(($||["prescription_summary","interaction_select","prescription","preparation","session"].includes(s))&&b){const r=Dt.find(w=>w.id===F);dt(r,B.ambient)}else pt()},[F,$,b,B.ambient,s,dt,pt]);const wt=()=>{de.current&&clearInterval(de.current),ht.current=0,it(),de.current=setInterval(()=>{ht.current>=3&&(clearInterval(de.current),console.log("[Session] AI ì—°ì† ì‹¤íŒ¨ â€” 35ì´ˆ ê°„ê²©ìœ¼ë¡œ ì „í™˜"),de.current=setInterval(()=>{it()},35e3)),it()},2e4)};n.useEffect(()=>{s==="diagnosis"&&ot.current&&ot.current.scrollIntoView({behavior:"smooth"})},[fe,ne,H,s]);const xn=async i=>{p(i);const t=ue.find(f=>f.id===i.prescription.modeId),r=i.prescription.type;P(t),Y(r);const w=D||{id:"sun"},I=yt(z,w.id,i.id);et(I),nt(i.id,w.id,t.id,r,""),d("prescription")},gn=async i=>{W(i);const t=ue.find(I=>I.id===c.prescription.modeId),r=c.prescription.type;P(t),Y(r);const w=yt(z,i.id,c.id);et(w),nt(c.id,i.id,t.id,r,""),d("prescription")},fn=()=>{C("Flow:StartFromPrescription"),d("preparation"),Be(3)},mn=async i=>{d("session"),Se(null),Jt.current=c?.id||null,Kt.current=0,Ne(!0),setTimeout(()=>Ne(!1),5e3);const t=Ye();t.state==="suspended"&&await t.resume();const r=b?B.binaural:0;if(Ke(200,i.freq,r),h==="v2")try{const f=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});Ue(f,t)}catch(f){console.error("Mic Error:",f),Se("ë§ˆì´í¬ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤."),Ce();return}else if(h==="v3")try{const f=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}});S.current=f,ke(f),pn()}catch(f){console.error("Camera Error:",f),Se("ì¹´ë©”ë¼ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤. ì„¤ì •ì—ì„œ ì¹´ë©”ë¼ ì ‘ê·¼ì„ í—ˆìš©í•´ì£¼ì„¸ìš”."),setTimeout(()=>Ce(),3e3);return}console.log(F==="none"?"ðŸŽµ [Audio Debug] No ambient sound selected (mode: 'none')":`ðŸŽµ [Audio Debug] Ambient '${F}' managing globally`),u(i.time),se(!0),a.current=!0;const I=E?.label?`ì„ íƒí•˜ì‹  '${E.label}'ì„(ë¥¼) ë§ˆìŒì— í’ˆê³ , í‰ì˜¨í•œ ì‹œê°„ì„ ì‹œìž‘í•©ë‹ˆë‹¤.`:"ìˆ¨ì„ ê¹Šê²Œ ë“¤ì´ë§ˆì‹œê³  ë‚´ì‰¬ë©°, ë‹¹ì‹ ë§Œì˜ í‰ì˜¨í•œ ì‹œê°„ì„ ì‹œìž‘í•©ë‹ˆë‹¤.";Oe(I),y&&(async()=>{try{const f=await qe({type:"session_message",memberName:O,timeContext:z,message:I,messageIndex:0});if(a.current){if(f.data?.message){const k=f.data.message.replace(/OOë‹˜/g,`${O}ë‹˜`);Oe(k)}f.data?.audioContent?ze(f.data.audioContent):le(I)}}catch(f){console.error("Intro TTS failed:",f),a.current&&le(I)}})(),St(),setTimeout(()=>{wt()},8e3)},St=()=>{De.current&&clearInterval(De.current),De.current=setInterval(()=>{u(i=>i<=1?(It(),0):i-1)},1e3)},hn=()=>{$?(clearInterval(De.current),clearInterval(de.current),K.current&&K.current.suspend(),be(),ee.current&&ee.current.pause(),se(!1),a.current=!1):(se(!0),a.current=!0,St(),wt(),K.current&&K.current.resume(),h==="v2"&&_e(),ee.current&&ee.current.play())},[at,kt]=n.useState(!1),bn=n.useCallback((i=!1)=>{if(kt(!0),de.current&&clearInterval(de.current),i&&fe.length<3){const t=["ì¡°ê¸ˆ ì•„ì‰½ì§€ë§Œ, ê´œì°®ì•„ìš”. ì§€ê¸ˆ ëŠë¼ì‹  ê·¸ëŒ€ë¡œ ì‹œìž‘í•´ë³¼ê²Œìš”. ðŸ™","ë” ëŒ€í™”í•˜ê³  ì‹¶ì—ˆì§€ë§Œ, ì§€ê¸ˆ ì´ ìˆœê°„ë„ ì†Œì¤‘í•´ìš”. í•¨ê»˜í•´ìš”.","ë§ˆìŒì´ ê¸‰í•˜ì‹œêµ°ìš”. ê´œì°®ì•„ìš”, ì§€ê¸ˆ ë°”ë¡œ í‰ì˜¨í•¨ìœ¼ë¡œ ì•ˆë‚´í• ê²Œìš”."],r=t[Math.floor(Math.random()*t.length)];Pe(w=>[...w,{role:"model",content:r}]),y&&le(r)}setTimeout(()=>{kt(!1),Ce(!0),d("interaction_select")},i&&fe.length<3?3e3:2e3)},[fe.length,y,le]),It=()=>{Ce(!1),d("feedback"),Re(!0);let i=null;if(h==="v3"&&We.current.length>0){const t=We.current,r=Math.round(t.reduce((I,f)=>I+f.score,0)/t.length),w=Array.from(He.current);i={stabilityScore:r,issues:w},console.log("ðŸ§˜ V3 Pose Analysis Result:",i)}(async()=>{try{const t=Date.now(),r=await qe({type:"feedback_message",memberName:O,timeContext:z,diagnosis:c?.id||"stress",mode:M?.id||"calm",poseMetrics:i});ut(Date.now()-t),r.data&&(r.data.message&&(r.data.message=r.data.message.replace(/OOë‹˜/g,`${O}ë‹˜`)),r.data.feedbackPoints&&(r.data.feedbackPoints=r.data.feedbackPoints.map(w=>w.replace(/OOë‹˜/g,`${O}ë‹˜`))),ft(r.data),r.data.audioContent?ze(r.data.audioContent):y&&r.data.message&&le(r.data.message))}catch(t){console.error("Feedback Generation Failed:",t),ft({message:`${O}ë‹˜, ì˜¤ëŠ˜ ëª…ìƒìœ¼ë¡œ ë§ˆìŒì´ í•œê²° íŽ¸ì•ˆí•´ì§€ì…¨ê¸¸ ë°”ëž˜ìš”.`,feedbackPoints:["ëª…ìƒì„ í†µí•´ ë‚´ë©´ì˜ ê³ ìš”í•¨ì„ ê²½í—˜í–ˆìŠµë‹ˆë‹¤.","í˜¸í¡ì— ì§‘ì¤‘í•˜ë©° í˜„ìž¬ì— ë¨¸ë¬´ë¥´ëŠ” ì—°ìŠµì„ í–ˆìŠµë‹ˆë‹¤.","ê¸´ìž¥í–ˆë˜ ëª¸ê³¼ ë§ˆìŒì´ ì¡°ê¸ˆ ë” ì´ì™„ë˜ì—ˆìŠµë‹ˆë‹¤.","ì˜¤ëŠ˜ í•˜ë£¨ë„ í‰ì˜¨í•œ ë§ˆìŒìœ¼ë¡œ ì´ì–´ê°€ì„¸ìš”."]})}finally{Re(!1)}})()},yn=i=>{const t=Math.floor(i/60),r=i%60;return`${t}:${r<10?"0":""}${r}`};if(s==="initial_prep")return e.jsxs("div",{style:{position:"fixed",inset:0,background:"#0a0a0c",zIndex:9999,display:"flex",flexDirection:"column",padding:"20px",overflow:"hidden"},children:[e.jsx("div",{className:`soul-light-base soul-theme-${j} active`,style:{transition:"all 1s ease",opacity:.4}}),e.jsxs("div",{style:{position:"relative",zIndex:10,display:"flex",flexDirection:"column",height:"100%",width:"100%",alignItems:"center",justifyContent:"center"},children:[e.jsx(ie,{isVisible:x,ttsState:g,currentStep:s,audioLevels:B,currentText:J,aiLatency:Z}),e.jsxs("div",{style:{width:"100%",maxWidth:"350px",animation:"fadeIn 0.5s ease",textAlign:"center"},children:[e.jsxs("div",{style:{marginBottom:"40px"},children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"20px"},children:"ðŸ”•"}),e.jsx("h3",{style:{fontSize:"1.5rem",fontWeight:700,color:"white",marginBottom:"10px"},children:"ì£¼ë³€ì„ ê³ ìš”í•˜ê²Œ"}),e.jsxs("p",{style:{color:"rgba(255,255,255,0.5)",lineHeight:1.6,marginBottom:"20px"},children:["ë°©í•´ë°›ì§€ ì•Šë„ë¡ ",e.jsx("br",{}),"ê¸°ê¸°ë¥¼ 'ë¬´ìŒ' ë˜ëŠ” 'ë°©í•´ê¸ˆì§€' ëª¨ë“œë¡œ ",e.jsx("br",{}),"ì„¤ì •í•´ì£¼ì…¨ë‚˜ìš”?"]}),e.jsxs("div",{style:{background:"rgba(76, 155, 251, 0.1)",border:"1px solid rgba(76, 155, 251, 0.2)",borderRadius:"15px",padding:"15px",marginTop:"10px",textAlign:"left",fontSize:"0.85rem"},children:[e.jsxs("div",{style:{color:"#4c9bfb",fontWeight:700,marginBottom:"5px",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(Me,{size:14,weight:"fill"})," ì•ˆì‹¬í•˜ì„¸ìš”"]}),e.jsx("div",{style:{color:"rgba(255,255,255,0.7)",lineHeight:1.5},children:"'ë¬´ìŒ'ì´ë‚˜ 'ë°©í•´ê¸ˆì§€' ëª¨ë“œì—ì„œë„ **ëª…ìƒ ê°€ì´ë“œì™€ ë°°ê²½ìŒì€ ì •ìƒì ìœ¼ë¡œ ë“¤ë¦½ë‹ˆë‹¤.** ì™¸ë¶€ ì•Œë¦¼ë§Œ ì°¨ë‹¨ë˜ë‹ˆ ì•ˆì‹¬í•˜ê³  ì„¤ì •í•´ì£¼ì„¸ìš”."})]})]}),e.jsx("button",{onClick:()=>{rt(i=>({...i,notified:!0})),d("intention")},style:{width:"100%",background:"var(--primary-gold)",color:"black",padding:"18px",borderRadius:"20px",fontSize:"1.1rem",fontWeight:800,border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:"í™•ì¸í–ˆìŠµë‹ˆë‹¤"})]})]})]});if(s==="intention"){if(an)return e.jsxs("div",{style:{position:"fixed",inset:0,background:"#0a0a0c",zIndex:9999,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:[e.jsx("div",{className:`soul-light-base soul-theme-${j} active`,style:{transition:"all 1s ease",opacity:.5}}),e.jsxs("div",{style:{zIndex:10,display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(ie,{isVisible:x,ttsState:g,currentStep:s,audioLevels:B,currentText:J,aiLatency:Z}),e.jsx(Lt,{})]})]});if(!N)return e.jsxs("div",{style:{position:"fixed",inset:0,background:"#0a0a0c",zIndex:9999,display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsx("div",{className:`soul-light-base soul-theme-${j} active`,style:{transition:"all 1s ease",opacity:.4}}),e.jsxs("div",{style:{padding:"15px 20px",paddingTop:"max(15px, env(safe-area-inset-top))",display:"flex",alignItems:"center",justifyContent:"space-between",background:"rgba(20, 20, 20, 0.4)",borderBottom:"1px solid rgba(255,255,255,0.05)",backdropFilter:"blur(20px)",zIndex:20},children:[e.jsx(ie,{isVisible:x,ttsState:g,currentStep:s,audioLevels:B,currentText:tn||J||H?.message,aiLatency:Z}),e.jsx("div",{onClick:X,style:{cursor:"pointer"},children:e.jsx("span",{style:{fontSize:"1.1rem",fontWeight:700,color:"white"},children:"ì˜¤ëŠ˜ì˜ ëª…ìƒ"})}),e.jsxs("button",{onClick:()=>{ce(),o?o():l(-1)},style:{padding:"8px 16px",border:"1px solid rgba(255,255,255,0.15)",borderRadius:"20px",background:"rgba(255, 255, 255, 0.08)",cursor:"pointer",color:"rgba(255,255,255,0.9)",fontSize:"0.85rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("span",{children:"ë‚˜ê°€ê¸°"}),e.jsx(Et,{size:16,weight:"bold"})]})]}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"center",padding:"100px 20px 40px",zIndex:10},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"50px"},children:[e.jsxs("h2",{style:{fontSize:"1.6rem",fontWeight:600,color:"#4c9bfb",marginBottom:"15px",lineHeight:1.4},children:["ì§€ê¸ˆ ë‹¹ì‹ ì˜ ë§ˆìŒì€",e.jsx("br",{}),"ì–´ë””ë¥¼ í–¥í•˜ê³  ìžˆë‚˜ìš”?"]}),e.jsx("p",{style:{fontSize:"0.9rem",color:"rgba(255,255,255,0.5)"},children:"ì˜¤ëŠ˜ ëª…ìƒì˜ í° ë°©í–¥ì„ ì„ íƒí•´ë³´ì„¸ìš”"})]}),e.jsx("div",{style:{width:"100%",maxWidth:"400px",display:"flex",flexDirection:"column",gap:"20px"},children:nn.map(t=>e.jsx("button",{onClick:()=>{q(t)},style:{padding:"30px 25px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"20px",color:"white",cursor:"pointer",transition:"all 0.3s ease",textAlign:"left"},onMouseEnter:r=>{r.currentTarget.style.background="rgba(76, 155, 251, 0.15)",r.currentTarget.style.borderColor="#4c9bfb",r.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:r=>{r.currentTarget.style.background="rgba(255, 255, 255, 0.05)",r.currentTarget.style.borderColor="rgba(255, 255, 255, 0.1)",r.currentTarget.style.transform="translateY(0)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[e.jsx("span",{style:{fontSize:"2rem",marginRight:"15px"},children:t.emoji}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:600,marginBottom:"5px"},children:t.label}),e.jsx("div",{style:{fontSize:"0.85rem",color:"rgba(255,255,255,0.5)"},children:t.description||t.subtitle})]})]})},t.id))})]})]});const i=sn.filter(t=>t.category===N.id);return e.jsxs("div",{style:{position:"fixed",inset:0,background:"#0a0a0c",zIndex:9999,display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsx("div",{className:`soul-light-base soul-theme-${j} active`,style:{transition:"all 1s ease",opacity:.4}}),e.jsxs("div",{style:{position:"relative",zIndex:10,display:"flex",flexDirection:"column",height:"100%",width:"100%"},children:[e.jsx(ie,{isVisible:x,ttsState:g,currentStep:s,audioLevels:B,currentText:J,aiLatency:Z}),e.jsxs("div",{style:{padding:"10px 15px",paddingTop:"max(10px, env(safe-area-inset-top))",display:"flex",alignItems:"center",background:"rgba(20, 20, 20, 0.4)",borderBottom:"1px solid rgba(255,255,255,0.05)",backdropFilter:"blur(20px)",zIndex:20},children:[e.jsx("button",{onClick:()=>q(null),style:{padding:"8px",border:"none",background:"none",cursor:"pointer"},children:e.jsx(Fe,{size:22,color:"white"})}),e.jsx("div",{style:{marginLeft:"10px"},children:e.jsx("span",{style:{fontSize:"1rem",fontWeight:600,color:"white"},children:N.label})})]}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"40px 20px"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:600,color:"#4c9bfb",marginBottom:"10px"},children:"ì¡°ê¸ˆ ë” êµ¬ì²´ì ìœ¼ë¡œ ë“¤ì—¬ë‹¤ë³¼ê¹Œìš”?"}),e.jsx("p",{style:{fontSize:"0.9rem",color:"rgba(255,255,255,0.6)",lineHeight:1.6},children:N.description})]}),e.jsx("div",{style:{width:"100%",maxWidth:"400px",display:"flex",flexDirection:"column",gap:"15px"},children:i.map(t=>e.jsx("button",{onClick:()=>{V(t),d("diagnosis"),bt([{role:"user",content:t.label}])},style:{padding:"20px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"15px",color:"white",fontSize:"1rem",cursor:"pointer",transition:"all 0.3s ease",textAlign:"left"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("span",{style:{marginRight:"12px",fontSize:"1.5rem"},children:t.emoji}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255,255,255,0.5)",marginBottom:"5px"},children:t.tag}),e.jsx("div",{style:{fontSize:"0.95rem"},children:t.label})]})]})},t.id))})]})]})]})}if(s==="diagnosis")return e.jsxs("div",{style:{position:"fixed",inset:0,background:"#0a0a0c",zIndex:9999,display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsx("div",{className:`soul-light-base soul-theme-${j} active`,style:{transition:"all 1s ease",opacity:.4}}),e.jsxs("div",{style:{position:"relative",zIndex:10,display:"flex",flexDirection:"column",height:"100%",width:"100%"},children:[e.jsx(ie,{isVisible:x,ttsState:g,currentStep:s,audioLevels:B,currentText:J,aiLatency:Z}),e.jsxs("div",{style:{padding:"10px 15px",paddingTop:"max(10px, env(safe-area-inset-top))",display:"flex",alignItems:"center",justifyContent:"space-between",background:"rgba(20, 20, 20, 0.4)",borderBottom:"1px solid rgba(255,255,255,0.05)",backdropFilter:"blur(20px)",zIndex:20},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("button",{onClick:()=>{ce(),o?o():l(-1)},style:{padding:"8px",border:"none",background:"none",cursor:"pointer"},children:e.jsx(Fe,{size:22,color:"white"})}),e.jsxs("div",{onClick:X,style:{marginLeft:"10px",display:"flex",flexDirection:"column",cursor:"pointer"},children:[e.jsx("span",{style:{fontSize:"1rem",fontWeight:600,color:"white"},children:"ë³µìˆœ (ë§ˆìŒ ì±™ê¹€ì´)"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(Me,{size:12,color:y?"#4caf50":"#666",weight:"fill"}),e.jsx("span",{style:{fontSize:"0.7rem",color:"rgba(255,255,255,0.6)"},children:at?e.jsx("span",{className:"blinking-text",children:"ë¶„ì„ ì¤‘..."}):ne?"ìƒê°í•˜ëŠ” ì¤‘...":"ìŒì„± ëŒ€í™” ì¤‘"})]})]})]}),!at&&e.jsx("button",{onClick:()=>bn(!0),style:{padding:"6px 12px",borderRadius:"20px",background:"rgba(76, 155, 251, 0.2)",border:"1px solid #4c9bfb",color:"#4c9bfb",fontSize:"0.8rem",fontWeight:"600",cursor:"pointer"},children:"ë°”ë¡œ ì‹œìž‘"})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px 15px",paddingBottom:"20px",display:"flex",flexDirection:"column",gap:"20px"},className:"no-scrollbar",children:[e.jsx("div",{style:{alignSelf:"center",background:"rgba(255,255,255,0.1)",padding:"4px 12px",borderRadius:"12px",fontSize:"0.75rem",color:"rgba(255,255,255,0.6)",marginBottom:"10px"},children:new Date().toLocaleDateString()}),fe.filter(i=>!i.content.startsWith("[System]:")).map((i,t)=>{const r=i.role==="user",w=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{style:{display:"flex",justifyContent:r?"flex-end":"flex-start",alignItems:"flex-start",gap:"8px"},children:[!r&&e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"var(--primary-gold)",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",border:"1px solid rgba(255,255,255,0.1)",flexShrink:0,fontSize:"1.2rem"},children:"ðŸ§˜â€â™€ï¸"}),e.jsxs("div",{style:{display:"flex",flexDirection:r?"row-reverse":"row",alignItems:"flex-end",gap:"6px"},children:[e.jsx("div",{style:{background:r?"linear-gradient(135deg, #d4af37, #f1c40f)":"rgba(255,255,255,0.08)",color:r?"#000":"#fff",padding:"12px 16px",borderRadius:r?"18px 4px 18px 18px":"4px 18px 18px 18px",maxWidth:"75vw",fontSize:"0.95rem",lineHeight:"1.6",boxShadow:"0 4px 15px rgba(0,0,0,0.2)",wordBreak:"keep-all",border:r?"none":"1px solid rgba(255,255,255,0.1)"},children:i.content}),e.jsx("span",{style:{fontSize:"0.7rem",color:"rgba(255,255,255,0.4)",marginBottom:"2px",minWidth:"55px",textAlign:r?"right":"left"},children:w})]})]},t)}),H&&!ne&&e.jsxs("div",{style:{display:"flex",justifyContent:"flex-start",alignItems:"flex-start",gap:"8px"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"white",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",border:"1px solid rgba(255,255,255,0.1)",flexShrink:0},children:e.jsx("img",{src:"/pwa-192x192.png",alt:"AI",style:{width:"100%",height:"100%",objectFit:"cover"},onError:i=>{i.target.style.display="none",i.target.parentNode.innerText="ðŸ§˜â€â™€ï¸"}})}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-end",gap:"6px"},children:[e.jsx("div",{style:{background:"rgba(255,255,255,0.08)",color:"white",padding:"14px 18px",borderRadius:"4px 18px 18px 18px",maxWidth:"75vw",fontSize:"1.0rem",lineHeight:"1.6",boxShadow:"0 4px 15px rgba(0,0,0,0.3)",border:"1px solid rgba(255,255,255,0.15)",backdropFilter:"blur(10px)"},children:H.message||H.question||"ì˜¤ëŠ˜ í•˜ë£¨ëŠ” ì–´ë– ì…¨ë‚˜ìš”?"}),e.jsx("span",{style:{fontSize:"0.7rem",color:"rgba(255,255,255,0.4)",marginBottom:"2px"},children:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]}),ne&&e.jsx("div",{style:{alignSelf:"center",marginTop:"10px"},children:e.jsx(Lt,{compact:!0,message:fe.length===0?"AI ë³µìˆœì´ê°€ ë‹¹ì‹ ì˜ ë§ˆìŒì„ ë“£ê³  ìžˆì–´ìš”...":null})}),e.jsx("div",{ref:ot,style:{height:"2px",width:"100%"}})]}),e.jsxs("div",{style:{background:"#1a1a1d",borderTop:"1px solid rgba(255,255,255,0.1)",padding:"15px",paddingBottom:"calc(15px + env(safe-area-inset-bottom))",display:"flex",flexDirection:"column",gap:"12px",zIndex:20},children:[!ne&&H?.isFinalAnalysis&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",animation:"fadeIn 0.5s ease"},children:[e.jsx("button",{onClick:()=>{ce();const i=Le.find(r=>r.id===H?.mappedDiagnosis)||Gn;p(i);const t=ue.find(r=>r.id===i?.prescription?.modeId)||ue[1];P(t),u(t.time),Y(i?.prescription?.type||"v1"),d("interaction_select")},style:{width:"100%",background:"var(--primary-gold)",color:"black",padding:"18px",borderRadius:"20px",fontSize:"1.1rem",fontWeight:800,border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",boxShadow:"0 10px 20px rgba(212,175,55,0.3)"},children:"ðŸ§˜ ëª…ìƒ ì‹œìž‘í•˜ê¸°"}),e.jsx("p",{style:{textAlign:"center",fontSize:"0.8rem",color:"rgba(255,255,255,0.4)"},children:"ë‹¹ì‹ ì—ê²Œ ë§žëŠ” ëª…ìƒì„ ì¤€ë¹„í–ˆì–´ìš”"})]}),!ne&&H?.options?.length>0&&!H?.isFinalAnalysis&&e.jsx("div",{className:"no-scrollbar",style:{display:"flex",gap:"8px",overflowX:"auto",paddingBottom:"10px",scrollbarWidth:"none",justifyContent:"flex-start"},children:H.options.map((i,t)=>e.jsx("button",{onClick:()=>{ce(),Qt(i)},style:{flex:"0 0 auto",background:"rgba(255,255,255,0.08)",border:"1px solid rgba(255,255,255,0.15)",padding:"10px 18px",borderRadius:"18px",color:"rgba(255,255,255,0.9)",fontSize:"0.9rem",cursor:"pointer",transition:"all 0.2s",backdropFilter:"blur(5px)"},children:i},t))}),!H?.isFinalAnalysis&&!H?.isTransition&&!at&&e.jsxs("form",{onSubmit:i=>{try{Zt(i)}catch{Re(!1)}},style:{display:"flex",gap:"10px",alignItems:"center",background:"rgba(255,255,255,0.05)",borderRadius:"28px",padding:"6px 6px 6px 20px",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx("input",{type:"text",value:$e,onChange:i=>Xt(i.target.value),disabled:ne,autoFocus:!0,placeholder:ne?"ë‹µë³€ì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...":"ì§ì ‘ ìž…ë ¥í•˜ê¸°...",style:{flex:1,background:"transparent",border:"none",color:"white",fontSize:"1rem",outline:"none"}}),e.jsx("button",{type:"submit",disabled:!$e.trim()||ne,style:{background:$e.trim()?"var(--primary-gold)":"rgba(255,255,255,0.1)",color:$e.trim()?"black":"rgba(255,255,255,0.2)",border:"none",borderRadius:"50%",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:e.jsx(qn,{size:24,weight:"bold"})})]})]})]})]});if(s==="diagnosis_manual")return e.jsxs("div",{style:{position:"fixed",inset:0,background:"#0a0a0c",zIndex:2e3,display:"flex",flexDirection:"column",padding:"20px",overflow:"hidden"},children:[e.jsx("div",{className:`soul-light-base soul-theme-${j} active`,style:{transition:"all 1s ease",opacity:.4}}),e.jsxs("div",{style:{position:"relative",zIndex:10,display:"flex",flexDirection:"column",height:"100%",width:"100%"},children:[e.jsx(ie,{isVisible:x,ttsState:g,currentStep:s,audioLevels:B,currentText:J,aiLatency:Z}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"30px"},children:[e.jsx("button",{onClick:()=>d("diagnosis"),style:{padding:"10px",color:"white",background:"none",border:"none"},children:e.jsx(Fe,{size:24})}),e.jsx("h1",{style:{flex:1,textAlign:"center",fontSize:"1.1rem",fontWeight:600,color:"rgba(255,255,255,0.5)",marginRight:"44px"},children:"ëª…ìƒ ì„ íƒ"})]}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",paddingTop:"30px"},children:[e.jsx("p",{style:{color:"rgba(255,255,255,0.6)",marginBottom:"25px",fontSize:"0.95rem"},children:"ì§€ê¸ˆ ëŠê»´ì§€ëŠ” ìƒíƒœë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",width:"100%",maxWidth:"400px"},children:Le.map(i=>e.jsxs("button",{onClick:()=>xn(i),style:{background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"20px",padding:"20px",display:"flex",flexDirection:"column",alignItems:"center",gap:"15px",transition:"all 0.3s ease",cursor:"pointer"},children:[e.jsx("div",{style:{width:"50px",height:"50px",borderRadius:"50%",background:`${i.color}20`,display:"flex",alignItems:"center",justifyContent:"center",color:i.color},children:e.jsx(i.icon,{size:28,weight:"fill"})}),e.jsx("span",{style:{color:"white",fontWeight:600},children:i.label})]},i.id))})]})]})]});if(s==="weather")return e.jsxs("div",{style:{position:"fixed",inset:0,background:"#0a0a0c",zIndex:2e3,display:"flex",flexDirection:"column",padding:"20px",overflow:"hidden"},children:[e.jsx("div",{className:`soul-light-base soul-theme-${j} active`,style:{transition:"all 1s ease",opacity:.4}}),e.jsxs("div",{style:{position:"relative",zIndex:10,display:"flex",flexDirection:"column",height:"100%",width:"100%"},children:[e.jsx(ie,{isVisible:x,ttsState:g,currentStep:s,audioLevels:B,currentText:J,aiLatency:Z}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"30px"},children:[e.jsx("button",{onClick:()=>d("diagnosis"),style:{padding:"10px",color:"white",background:"none",border:"none"},children:e.jsx(Fe,{size:24})}),e.jsx("h1",{style:{flex:1,textAlign:"center",fontSize:"1.1rem",fontWeight:600,color:"rgba(255,255,255,0.5)",marginRight:"44px"},children:"í™˜ê²½ ê°ì§€"})]}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",paddingTop:"40px"},children:[e.jsx("h2",{style:{fontSize:"1.6rem",fontWeight:700,color:"white",marginBottom:"10px",textAlign:"center"},children:"ì§€ê¸ˆ ì°½ë°–ì˜ ë‚ ì”¨ëŠ” ì–´ë–¤ê°€ìš”?"}),e.jsx("p",{style:{color:"rgba(255,255,255,0.5)",marginBottom:"50px",textAlign:"center",fontSize:"0.9rem"},children:"ë‚ ì”¨ì— ë”°ë¼ ë‡Œì˜ ë°˜ì‘ íŒ¨í„´ì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",width:"100%",maxWidth:"400px"},children:pe.map(i=>e.jsxs("button",{onClick:()=>gn(i),style:{background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"20px",padding:"24px",display:"flex",flexDirection:"column",alignItems:"center",gap:"10px",cursor:"pointer"},children:[e.jsx(i.icon,{size:36,color:i.color,weight:"duotone"}),e.jsx("span",{style:{color:"white",fontSize:"1.1rem",marginTop:"5px"},children:i.label})]},i.id))})]})]})]});if(s==="prescription_summary"){const i=H?.analysisSummary||Ze||"ë‹¹ì‹ ì˜ ë§ˆìŒ ìƒíƒœë¥¼ ê¹Šì´ ë“¤ì—¬ë‹¤ë³´ì•˜ìŠµë‹ˆë‹¤.";return e.jsxs("div",{style:{position:"fixed",inset:0,background:"#0a0a0c",zIndex:2e3,display:"flex",flexDirection:"column",padding:"20px",overflow:"hidden"},children:[e.jsx("div",{className:`soul-light-base soul-theme-${j} active`,style:{transition:"all 1s ease",opacity:.4}}),e.jsxs("div",{style:{position:"relative",zIndex:10,display:"flex",flexDirection:"column",height:"100%",width:"100%",alignItems:"center",justifyContent:"center"},children:[e.jsxs("div",{style:{marginBottom:"30px",color:"var(--primary-gold)",textAlign:"center"},children:[e.jsx(Vt,{size:60,weight:"fill"}),e.jsx("h2",{style:{fontSize:"1.8rem",fontWeight:800,color:"white",marginTop:"20px"},children:"AI ë§ˆìŒ ë¶„ì„"})]}),e.jsx("div",{style:{width:"100%",maxWidth:"400px",background:"rgba(255,255,255,0.08)",borderRadius:"24px",padding:"30px",border:"1px solid rgba(255,255,255,0.1)",marginBottom:"40px",boxShadow:"0 20px 40px rgba(0,0,0,0.5)"},children:e.jsxs("p",{style:{color:"white",fontSize:"1.15rem",lineHeight:1.7,textAlign:"center",wordBreak:"keep-all"},children:['"',i,'"']})}),e.jsx("button",{onClick:()=>d("interaction_select"),style:{width:"100%",maxWidth:"300px",background:"var(--primary-gold)",color:"black",padding:"20px",borderRadius:"20px",fontSize:"1.2rem",fontWeight:800,border:"none",cursor:"pointer",boxShadow:"0 10px 20px rgba(212,175,55,0.3)"},children:"ëª…ìƒ ëª¨ë“œ ì„ íƒí•˜ê¸°"}),e.jsx("button",{onClick:()=>{const t=["ë‹¤ì‹œ ëŒì•„ì˜¤ì…¨êµ°ìš”! ë” ì´ì•¼ê¸° ë‚˜ëˆ ë³¼ê¹Œìš”? ðŸ˜Š","ì¢‹ì•„ìš”, ì¡°ê¸ˆ ë” ê¹Šì´ ë“¤ì—¬ë‹¤ë³¼ê²Œìš”. ì§€ê¸ˆ ì–´ë– ì„¸ìš”?","ì²œì²œížˆ ê°€ë„ ê´œì°®ì•„ìš”. ë” ì´ì•¼ê¸°í•´ì£¼ì‹œë©´ ë” ìž˜ ë„ì™€ë“œë¦´ ìˆ˜ ìžˆì–´ìš”."],r=t[Math.floor(Math.random()*t.length)];Pe(w=>[...w,{role:"model",content:r}]),y&&le(r),d("diagnosis")},style:{marginTop:"20px",background:"none",border:"none",color:"rgba(255,255,255,0.4)",textDecoration:"underline"},children:"ëŒ€í™” ë” í•˜ê¸°"})]})]})}if(s==="interaction_select")return e.jsxs("div",{style:{position:"fixed",inset:0,background:"#0a0a0c",zIndex:2e3,display:"flex",flexDirection:"column",padding:"20px",overflow:"hidden"},children:[e.jsx("div",{className:`soul-light-base soul-theme-${j} active`,style:{transition:"all 1s ease",opacity:.4}}),e.jsxs("div",{style:{position:"relative",zIndex:10,display:"flex",flexDirection:"column",height:"100%",width:"100%"},children:[e.jsxs("div",{style:{padding:"20px 0",textAlign:"center"},children:[e.jsx("h2",{style:{fontSize:"1.6rem",fontWeight:800,color:"white"},children:"ì–´ë–¤ ëª…ìƒì„ ì›í•˜ì‹œë‚˜ìš”?"}),e.jsx("p",{style:{color:"rgba(255,255,255,0.5)",marginTop:"8px"},children:"ë‚˜ì—ê²Œ ê°€ìž¥ í•„ìš”í•œ ëª¨ë“œë¥¼ ì„ íƒí•˜ì„¸ìš”"})]}),e.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"15px",justifyContent:"center",width:"100%",maxWidth:"400px",margin:"0 auto"},children:Object.values(Bt).map(i=>e.jsxs("button",{onClick:()=>{Y(i.id);const t=ue.find(r=>r.id===c?.prescription.modeId)||ue[1];P(t),u(t.time),nt(c?.id||"stress",D?.id||"sun",t.id,i.id,""),d("preparation"),Be(3)},style:{display:"flex",alignItems:"center",gap:"20px",padding:"25px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"24px",color:"white",textAlign:"left",cursor:"pointer",transition:"all 0.3s"},children:[e.jsx("div",{style:{width:"50px",height:"50px",borderRadius:"15px",background:"rgba(212,175,55,0.1)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--primary-gold)"},children:i.id==="v1"?e.jsx(Ht,{size:28}):i.id==="v2"?e.jsx(ct,{size:28}):e.jsx(qt,{size:28})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:"1.15rem",fontWeight:700,marginBottom:"4px"},children:i.label}),e.jsx("div",{style:{fontSize:"0.85rem",color:"rgba(255,255,255,0.5)",lineHeight:1.4},children:i.desc})]})]},i.id))})]})]});if(s==="prescription"&&c&&M){const i=Nt[M.iconName]||Nt.Wind;return e.jsxs("div",{style:{position:"fixed",inset:0,background:"#0a0a0c",zIndex:2e3,display:"flex",flexDirection:"column",padding:"20px",overflow:"hidden"},children:[e.jsx("div",{className:`soul-light-base soul-theme-${j} active`,style:{transition:"all 1s ease",opacity:.4}}),e.jsxs("div",{style:{position:"relative",zIndex:10,display:"flex",flexDirection:"column",height:"100%",width:"100%",overflowY:"auto"},className:"no-scrollbar",children:[e.jsx(ie,{isVisible:x,ttsState:g,currentStep:s,audioLevels:B,currentText:J,aiLatency:Z}),e.jsxs("div",{style:{marginTop:"20px",flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",paddingBottom:"40px"},children:[e.jsx("div",{style:{marginBottom:"20px",color:"var(--primary-gold)"},children:e.jsx(Gt,{size:48,weight:"fill"})}),e.jsx("h2",{style:{fontSize:"1.4rem",fontWeight:700,color:"white",marginBottom:"20px",textAlign:"center"},children:"ëª…ìƒ ì „ë¬¸ AI ì²˜ë°©"}),e.jsxs("div",{style:{width:"100%",maxWidth:"350px",background:"rgba(255,255,255,0.08)",borderRadius:"24px",padding:"20px",border:"1px solid rgba(255,255,255,0.1)",display:"flex",flexDirection:"column",gap:"15px"},children:[e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"15px",borderRadius:"15px",fontSize:"0.9rem",color:"rgba(255,255,255,0.9)",lineHeight:1.6},children:[e.jsx("div",{style:{color:"var(--primary-gold)",fontWeight:700,marginBottom:"8px",fontSize:"0.85rem"},children:"ðŸ“‹ AI ë³µìˆœì´ì˜ ì‹¬ë¦¬ ë¶„ì„"}),e.jsx("div",{children:H?.isFinalAnalysis&&H.analysisSummary||Ze})]}),e.jsx("div",{style:{height:"1px",background:"rgba(255,255,255,0.1)",margin:"5px 0"}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"18px",background:`${M.color}30`,display:"flex",alignItems:"center",justifyContent:"center",color:M.color},children:e.jsx(i,{size:32,weight:"duotone"})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.85rem",color:"var(--primary-gold)",fontWeight:600,marginBottom:"2px"},children:"âœ¨ AI ê°•ë ¥ ì¶”ì²œ"}),e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:700,color:"white"},children:M.label}),e.jsxs("div",{style:{fontSize:"0.85rem",color:"rgba(255,255,255,0.6)"},children:[h==="v1"&&"ì˜¨ëª¸ ì´ì™„ ê°€ì´ë“œ",h==="v2"&&"í˜¸í¡ ëª°ìž…",h==="v3"&&"ìžì„¸ êµì •"]})]})]}),e.jsxs("div",{style:{marginTop:"10px"},children:[e.jsx("div",{style:{color:"rgba(255,255,255,0.5)",fontSize:"0.75rem",marginBottom:"10px"},children:"ì˜µì…˜ ë³€ê²½í•˜ê¸°"}),e.jsx("div",{style:{marginBottom:"10px",display:"flex",gap:"8px"},children:ue.map(t=>e.jsx("button",{onClick:()=>{P(t),u(t.time)},style:{flex:1,padding:"8px",borderRadius:"10px",fontSize:"0.75rem",background:M.id===t.id?"rgba(255,255,255,0.2)":"rgba(255,255,255,0.05)",color:M.id===t.id?"white":"rgba(255,255,255,0.6)",border:M.id===t.id?"1px solid rgba(255,255,255,0.3)":"none",fontWeight:600},children:t.label.split(" ")[0]},t.id))}),e.jsx("div",{style:{display:"flex",gap:"8px"},children:Object.values(Bt).map(t=>e.jsx("button",{onClick:()=>Y(t.id),style:{flex:1,padding:"8px",borderRadius:"10px",fontSize:"0.75rem",background:h===t.id?"rgba(255,255,255,0.2)":"rgba(255,255,255,0.05)",color:h===t.id?"white":"rgba(255,255,255,0.6)",border:h===t.id?"1px solid rgba(255,255,255,0.3)":"none",fontWeight:600},children:t.id==="v1"?"ë°”ë””ìŠ¤ìº”":t.id==="v2"?"í˜¸í¡":"ìžì„¸"},t.id))}),e.jsxs("div",{style:{marginTop:"15px"},children:[e.jsx("div",{style:{color:"rgba(255,255,255,0.5)",fontSize:"0.75rem",marginBottom:"8px"},children:"ðŸŽµ ë°°ê²½ìŒ"}),e.jsx("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:Dt.map(t=>e.jsx("button",{onClick:()=>Q(t.id),style:{padding:"6px 12px",borderRadius:"12px",fontSize:"0.7rem",background:F===t.id?`${t.color}30`:"rgba(255,255,255,0.05)",color:F===t.id?t.color:"rgba(255,255,255,0.5)",border:F===t.id?`1px solid ${t.color}50`:"1px solid transparent",fontWeight:600,cursor:"pointer"},children:t.label},t.id))})]})]})]}),e.jsxs("div",{style:{width:"100%",maxWidth:"350px",marginTop:"30px"},children:[e.jsxs("button",{onClick:fn,style:{width:"100%",background:"var(--primary-gold)",color:"black",padding:"16px",borderRadius:"18px",fontSize:"1.1rem",fontWeight:800,border:"none",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",cursor:"pointer",boxShadow:"0 10px 20px rgba(212,175,55,0.3)"},children:[e.jsx(_t,{size:24,weight:"fill"})," ì‹œìž‘í•˜ê¸°"]}),e.jsx("button",{onClick:en,style:{marginTop:"15px",width:"100%",background:"transparent",border:"none",color:"rgba(255,255,255,0.4)",textDecoration:"underline",cursor:"pointer",fontSize:"0.85rem"},children:"ë‹¤ì‹œ ì„ íƒ (ëŒ€í™”ë¡œ ëŒì•„ê°€ê¸°)"})]})]})]})]})}if(s==="preparation"){const i={chair:{title:"ì˜ìž ëª…ìƒ",desc:"íšŒì‚¬ë‚˜ ì§‘ì—ì„œ ê°„íŽ¸í•˜ê²Œ",steps:["ì˜ìž ì•žìª½ì— ê±¸í„°ì•‰ì•„ í—ˆë¦¬ë¥¼ ì„¸ì›ë‹ˆë‹¤.","ì–‘ë°œì€ ì–´ê¹¨ë„ˆë¹„ë¡œ ë²Œë ¤ ì§€ë©´ì— ë‹¿ê²Œ í•©ë‹ˆë‹¤.","ì†ì€ íŽ¸ì•ˆí•˜ê²Œ ë¬´ë¦Ž ìœ„ì— ì˜¬ë¦½ë‹ˆë‹¤."]},floor:{title:"ë°”ë‹¥ ëª…ìƒ",desc:"ì¡°ìš©í•˜ê³  ì•ˆì •ì ì¸ ê³µê°„ì—ì„œ",steps:["ê°€ë¶€ì¢Œ ë˜ëŠ” íŽ¸í•œ ì±…ìƒë‹¤ë¦¬ë¥¼ í•©ë‹ˆë‹¤.","ì¿ ì…˜ì„ í™œìš©í•´ ë¬´ë¦Žì´ ì—‰ë©ì´ë³´ë‹¤ ë‚®ê²Œ í•©ë‹ˆë‹¤.","ì²™ì¶”ë¥¼ ê³§ê²Œ íŽ´ê³  ì •ìˆ˜ë¦¬ë¥¼ í•˜ëŠ˜ë¡œ ë‹¹ê¹ë‹ˆë‹¤."]},lying:{title:"ëˆ„ìš´ ëª…ìƒ",desc:"ê¹Šì€ ì´ì™„ê³¼ ìˆ˜ë©´ì„ ìœ„í•´",steps:["ë“±ì„ ëŒ€ê³  íŽ¸ì•ˆí•˜ê²Œ ëˆ•ìŠµë‹ˆë‹¤.","ë‹¤ë¦¬ëŠ” ì–´ê¹¨ë„ˆë¹„ë¡œ ë²Œë¦¬ê³  ë°œëì„ íˆ­ ë–¨ì–´ëœ¨ë¦½ë‹ˆë‹¤.","íŒ”ì€ ëª¸ ì˜†ì— ë‘ê³  ì†ë°”ë‹¥ì´ í•˜ëŠ˜ì„ í–¥í•˜ê²Œ í•©ë‹ˆë‹¤."]}};return e.jsxs("div",{style:{position:"fixed",inset:0,background:"#0a0a0c",zIndex:2e3,display:"flex",flexDirection:"column",padding:"20px",overflow:"hidden"},children:[e.jsx("div",{className:`soul-light-base soul-theme-${j} active`,style:{transition:"all 1s ease",opacity:.4}}),e.jsxs("div",{style:{position:"relative",zIndex:10,display:"flex",flexDirection:"column",height:"100%",width:"100%"},children:[e.jsx(ie,{isVisible:x,ttsState:g,currentStep:s,audioLevels:B,currentText:J,aiLatency:Z}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"30px"},children:[e.jsx("button",{onClick:()=>d("interaction_select"),style:{padding:"10px",color:"white",background:"none",border:"none"},children:e.jsx(Fe,{size:24})}),e.jsxs("div",{style:{flex:1,textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--primary-gold)",fontWeight:600},children:["ì¤€ë¹„ ë‹¨ê³„ (",ve,"/3)"]}),e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700,color:"white"},children:"ëª…ìƒ ì¤€ë¹„"})]}),e.jsx("div",{style:{width:"44px"}})]}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",paddingTop:"10px"},children:[ve===1&&e.jsxs("div",{style:{width:"100%",maxWidth:"350px",animation:"fadeIn 0.5s ease"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"20px"},children:"ðŸ”•"}),e.jsx("h3",{style:{fontSize:"1.5rem",fontWeight:700,color:"white",marginBottom:"10px"},children:"ì£¼ë³€ì„ ê³ ìš”í•˜ê²Œ"}),e.jsxs("p",{style:{color:"rgba(255,255,255,0.5)",lineHeight:1.6,marginBottom:"20px"},children:["ë°©í•´ë°›ì§€ ì•Šë„ë¡ ",e.jsx("br",{}),"ê¸°ê¸°ë¥¼ 'ë¬´ìŒ' ë˜ëŠ” 'ë°©í•´ê¸ˆì§€' ëª¨ë“œë¡œ ",e.jsx("br",{}),"ì„¤ì •í•´ì£¼ì…¨ë‚˜ìš”?"]}),e.jsxs("div",{style:{background:"rgba(76, 155, 251, 0.1)",border:"1px solid rgba(76, 155, 251, 0.2)",borderRadius:"15px",padding:"15px",marginTop:"10px",textAlign:"left",fontSize:"0.85rem"},children:[e.jsxs("div",{style:{color:"#4c9bfb",fontWeight:700,marginBottom:"5px",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(Me,{size:14,weight:"fill"})," ì•ˆì‹¬í•˜ì„¸ìš”"]}),e.jsx("div",{style:{color:"rgba(255,255,255,0.7)",lineHeight:1.5},children:"'ë¬´ìŒ'ì´ë‚˜ 'ë°©í•´ê¸ˆì§€' ëª¨ë“œì—ì„œë„ **ëª…ìƒ ê°€ì´ë“œì™€ ë°°ê²½ìŒì€ ì •ìƒì ìœ¼ë¡œ ë“¤ë¦½ë‹ˆë‹¤.** ì™¸ë¶€ ì•Œë¦¼ë§Œ ì°¨ë‹¨ë˜ë‹ˆ ì•ˆì‹¬í•˜ê³  ì„¤ì •í•´ì£¼ì„¸ìš”."})]})]}),e.jsx("button",{onClick:()=>{rt({...me,notified:!0}),Be(2)},style:{width:"100%",background:"var(--primary-gold)",color:"black",padding:"18px",borderRadius:"20px",fontSize:"1.1rem",fontWeight:800,border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:"í™•ì¸í–ˆìŠµë‹ˆë‹¤"})]}),ve===3&&e.jsxs("div",{style:{width:"100%",maxWidth:"400px",animation:"fadeIn 0.5s ease"},children:[e.jsx("h3",{style:{fontSize:"1.3rem",fontWeight:700,color:"white",marginBottom:"15px",textAlign:"center"},children:"ê°€ìž¥ íŽ¸í•œ ìžì„¸ë¥¼ ì°¾ì•„ë³´ì„¸ìš”"}),e.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"15px"},children:Object.entries(i).map(([t,r])=>e.jsx("button",{onClick:()=>rt({...me,posture:t}),style:{flex:1,padding:"10px 4px",borderRadius:"12px",fontSize:"0.8rem",background:me.posture===t?"rgba(255,255,255,0.15)":"rgba(255,255,255,0.03)",color:me.posture===t?"white":"rgba(255,255,255,0.4)",border:me.posture===t?"1px solid rgba(255,255,255,0.3)":"1px solid transparent",fontWeight:600},children:r.title},t))}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"24px",padding:"20px",border:"1px solid rgba(255,255,255,0.1)",marginBottom:"20px",minHeight:"180px"},children:[e.jsx("div",{style:{color:"var(--primary-gold)",fontSize:"0.75rem",fontWeight:700,marginBottom:"4px"},children:i[me.posture].desc}),e.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:800,color:"white",marginBottom:"12px"},children:[i[me.posture].title," ìžì„¸"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:i[me.posture].steps.map((t,r)=>e.jsxs("div",{style:{display:"flex",gap:"8px",color:"rgba(255,255,255,0.8)",fontSize:"0.9rem",lineHeight:1.4},children:[e.jsx("span",{style:{color:"var(--primary-gold)",fontWeight:800},children:r+1}),e.jsx("span",{children:t})]},r))})]}),e.jsx("button",{onClick:()=>Be(2),style:{width:"100%",background:"white",color:"black",padding:"18px",borderRadius:"20px",fontSize:"1.1rem",fontWeight:800,border:"none",cursor:"pointer",marginBottom:"15px"},children:"ê¸°ê¸° ìœ„ì¹˜ ì„¤ì •ìœ¼ë¡œ"})]}),ve===2&&e.jsxs("div",{style:{width:"100%",maxWidth:"350px",animation:"fadeIn 0.5s ease"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"20px"},children:h==="v3"?"ðŸ“":h==="v2"?"ðŸ‘„":"ðŸ“±"}),e.jsx("h3",{style:{fontSize:"1.5rem",fontWeight:700,color:"white",marginBottom:"10px"},children:"í•¸ë“œí° ìœ„ì¹˜ ì„¤ì •"}),e.jsx("p",{style:{color:"rgba(255,255,255,0.7)",lineHeight:1.6,fontSize:"1.1rem"},children:h==="v3"?"ì „ì‹  ì´¬ì˜ì„ ìœ„í•´ í•¸ë“œí°ì„ ì•½ 2m ê±°ë¦¬ì— ì„¸ì›Œë‘ì„¸ìš”.":h==="v2"?"ìˆ¨ì†Œë¦¬ ê°ì§€ë¥¼ ìœ„í•´ í•¸ë“œí°ì„ ìž… ê·¼ì²˜(30cm ë‚´)ì— ë¹„ìŠ¤ë“¬ížˆ ì„¸ì›Œë‘ì„¸ìš”.":"í•¸ë“œí°ì„ ì†ì´ ë‹¿ëŠ” íŽ¸í•œ ê³³ì— ë‘ì„¸ìš”."}),h==="v2"&&e.jsxs("div",{style:{marginTop:"20px",padding:"12px",background:"rgba(74, 222, 128, 0.1)",borderRadius:"12px",border:"1px solid rgba(74, 222, 128, 0.2)",fontSize:"0.85rem",color:"#4ade80"},children:["ðŸ’¡ ",e.jsx("b",{children:"Tip:"})," ë§ˆì´í¬ê°€ í¬í•¨ëœ ì´ì–´í°ì„ ì‚¬ìš©í•˜ì‹œë©´ ìˆ¨ì†Œë¦¬ë¥¼ í›¨ì”¬ ë” ì •í™•í•˜ê²Œ ê°ì§€í•  ìˆ˜ ìžˆì–´ìš”."]})]}),e.jsx("button",{onClick:()=>mn(M),style:{width:"100%",background:"var(--primary-gold)",color:"black",padding:"18px",borderRadius:"20px",fontSize:"1.1rem",fontWeight:800,border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:"ì¤€ë¹„ ì™„ë£Œ (ëª…ìƒ ì‹œìž‘)"})]})]})]})]})}if(s==="feedback"){const i=gt?.feedbackPoints||[];return e.jsx(Wn,{visualTheme:j,isDebugMode:x,ttsState:g,step:s,audioVolumes:B,aiMessage:J,aiLatency:Z,isAILoading:ne,points:i,feedbackData:gt,stopAllAudio:ce,setAiMessage:Oe,setChatHistory:Pe,onClose:o})}return e.jsxs("div",{style:{position:"fixed",inset:0,background:"#0a0a0c",zIndex:3e3,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:[h==="v3"&&e.jsxs("div",{style:{position:"absolute",inset:0,zIndex:1,opacity:.6},children:[e.jsx("video",{ref:ee,autoPlay:!0,playsInline:!0,muted:!0,style:{width:"100%",height:"100%",objectFit:"cover",transform:"scaleX(-1)"}}),e.jsx("canvas",{ref:st,width:window.innerWidth,height:window.innerHeight,style:{position:"absolute",inset:0,width:"100%",height:"100%",transform:"scaleX(-1)",pointerEvents:"none"}}),e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"280px",height:"350px",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"120px",boxShadow:"0 0 80px rgba(255, 215, 0, 0.1) inset"}})]}),e.jsx("div",{className:`soul-light-base soul-theme-${j} ${$&&h!=="v2"?"active":""}`,style:{transform:h==="v2"&&$?`translate(-50%, -50%) scale(${1+Math.min(oe,.5)})`:void 0,transition:h==="v2"?"transform 0.1s ease-out":"all 1s ease",zIndex:0}}),e.jsxs("div",{style:{zIndex:10,textAlign:"center",width:"100%",padding:"20px",maxWidth:"600px"},children:[e.jsx("div",{style:{marginBottom:"20px",minHeight:"80px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("p",{style:{color:"white",fontSize:"1.2rem",fontWeight:500,lineHeight:1.6,opacity:$?1:.5,transition:"opacity 1s ease",textShadow:"0 4px 20px rgba(0,0,0,0.8)",background:h==="v3"?"rgba(0,0,0,0.6)":"transparent",padding:h==="v3"?"15px":"0",borderRadius:"15px"},children:J})}),e.jsx("div",{style:{fontSize:"4.5rem",fontWeight:200,color:"white",fontVariantNumeric:"tabular-nums",letterSpacing:"-2px",textShadow:"0 0 30px rgba(255,255,255,0.3)",marginBottom:"10px"},children:yn(he)}),h==="v2"&&e.jsxs("div",{style:{marginTop:"20px",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",animation:"fadeIn 0.5s ease"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:oe>.1?"#4ade80":"rgba(255,255,255,0.3)",transition:"color 0.2s"},children:[e.jsx(ct,{size:20,weight:oe>.1?"fill":"regular",style:{transform:`scale(${1+Math.min(oe,.5)})`}}),e.jsx("span",{style:{fontSize:"0.8rem",fontWeight:600,letterSpacing:"1px"},children:"BREATH LEVEL"})]}),e.jsx("div",{style:{width:"120px",height:"4px",background:"rgba(255,255,255,0.1)",borderRadius:"2px",overflow:"hidden",boxShadow:"0 0 10px rgba(0,0,0,0.5)"},children:e.jsx("div",{style:{height:"100%",width:`${Math.min(oe*100,100)}%`,background:"linear-gradient(90deg, #4ade80, #32ff7e)",transition:"width 0.1s ease-out",boxShadow:"0 0 10px rgba(74, 222, 128, 0.5)"}})}),oe>.1&&e.jsx("span",{style:{fontSize:"0.7rem",color:"#4ade80",animation:"pulse 1s infinite"},children:"ê°ì§€ ì¤‘..."})]}),e.jsx("div",{style:{height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},children:y?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",color:"var(--primary-gold)",fontSize:"0.8rem",fontWeight:"bold",animation:"pulse 2s infinite"},children:[e.jsx(Me,{size:16,weight:"fill"})," ìŒì„± ì•ˆë‚´ê°€ ì§„í–‰ ì¤‘ìž…ë‹ˆë‹¤"]}):(h==="v2"||h==="v3")&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",color:"rgba(255,255,255,0.4)",fontSize:"0.75rem"},children:[e.jsx(Ln,{size:12,weight:"fill",color:"#4ade80"})," ë°ì´í„°ëŠ” ê¸°ê¸° ë‚´ì—ì„œë§Œ ì²˜ë¦¬ë©ë‹ˆë‹¤"]})}),ye&&e.jsxs("div",{style:{marginTop:"20px",padding:"10px",background:"rgba(255,0,0,0.2)",color:"#ff6b6b",borderRadius:"8px",fontSize:"0.9rem"},children:["âš ï¸ ",ye]})]}),e.jsxs("div",{style:{position:"absolute",bottom:"60px",display:"flex",alignItems:"center",gap:"40px",zIndex:20},children:[e.jsx("button",{onClick:()=>{It()},style:{width:"60px",height:"60px",borderRadius:"50%",background:"rgba(255,255,255,0.1)",border:"none",color:"white",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:e.jsx(Et,{size:28})}),e.jsx("button",{onClick:hn,style:{width:"80px",height:"80px",borderRadius:"50%",background:M?.color,border:"none",color:"#000",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 0 30px ${M?.color}60`,cursor:"pointer"},children:$?e.jsx(Mn,{size:32,weight:"fill"}):e.jsx(_t,{size:32,weight:"fill"})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[e.jsx("button",{onClick:()=>Ee(!Ie),style:{width:"60px",height:"60px",borderRadius:"50%",background:Ie?"rgba(212,175,55,0.3)":"rgba(255,255,255,0.1)",border:"none",color:b?"white":"rgba(255,255,255,0.3)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s ease"},children:b?e.jsx(Me,{size:28}):e.jsx(Fn,{size:28})}),e.jsx("span",{style:{fontSize:"0.65rem",color:"rgba(255,255,255,0.5)",fontWeight:"600"},children:"ì†Œë¦¬ ì¡°ì ˆ"})]})]}),e.jsx(Rn,{showVolumePanel:Ie,setShowVolumePanel:Ee,audioVolumes:B,setAudioVolumes:xe,currentAudioRef:T,updateAmbientVolume:Je,updateBinauralVolume:Ae,soundEnabled:b,setSoundEnabled:L}),Xe&&!Ie&&e.jsx("div",{style:{position:"absolute",bottom:"190px",left:"50%",transform:"translateX(-50%)",background:"rgba(212,175,55,0.2)",backdropFilter:"blur(10px)",border:"1px solid rgba(212,175,55,0.3)",borderRadius:"20px",padding:"8px 16px",color:"rgba(255,255,255,0.8)",fontSize:"0.75rem",whiteSpace:"nowrap",animation:"fadeIn 0.5s ease-out",pointerEvents:"none"},children:"ðŸ”Š ìŠ¤í”¼ì»¤ ì•„ì´ì½˜ì„ ëˆŒëŸ¬ ë³¼ë¥¨ì„ ì¡°ì ˆí•˜ì„¸ìš”"}),e.jsx(ie,{isVisible:x,ttsState:g,currentStep:s,audioLevels:B,currentText:J,aiLatency:Z}),e.jsx("style",{children:`
                .no-scrollbar::-webkit-scrollbar {
                    display: none;
                }
                .no-scrollbar {
                    -ms-overflow-style: none;  /* IE and Edge */
                    scrollbar-width: none;  /* Firefox */
                }
                @keyframes breathe {
                    0%, 100% { transform: scale(1); opacity: 0.5; }
                    50% { transform: scale(1.5); opacity: 0.8; }
                }
                @keyframes breathe-inner {
                    0%, 100% { transform: scale(1); opacity: 0.8; }
                    50% { transform: scale(1.3); opacity: 0.4; }
                }
                @keyframes float {
                    0% { transform: rotate(0deg) scale(1) translate(0, 0); }
                    33% { transform: rotate(120deg) scale(1.1) translate(20px, -20px); }
                    66% { transform: rotate(240deg) scale(0.9) translate(-20px, 20px); }
                    100% { transform: rotate(360deg) scale(1) translate(0, 0); }
                }
                @keyframes float-rev {
                    0% { transform: rotate(0deg) scale(1.1) translate(0, 0); }
                    50% { transform: rotate(-180deg) scale(0.9) translate(30px, 30px); }
                    100% { transform: rotate(-360deg) scale(1.1) translate(0, 0); }
                }

                .breathing-circle.animate { animation: breathe 8s infinite ease-in-out; }
                .breathing-circle-inner.animate-inner { animation: breathe-inner 8s infinite ease-in-out; }
                .floating-circle.animate-float { animation: float 20s infinite linear; }
                .floating-circle-rev.animate-float-rev { animation: float-rev 25s infinite linear; }
                .paused { animation-play-state: paused !important; }
                @keyframes fadeIn {
                    from { opacity: 0; transform: translateY(10px); }
                    to { opacity: 1; transform: translateY(0); }
                }
            `})]})};export{Qn as default};
//# sourceMappingURL=MeditationPage-C3pt8ShF-v7.js.map
